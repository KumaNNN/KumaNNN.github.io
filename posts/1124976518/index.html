<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="==TP5第一天==一、框架概述1、什么是框架框架(Framework)，它是许多代码文件的集合，这些代码文件是程序结构的代码，不是业务代码，里面包含了许多函数、类库(分页类、验证码类、文件上传类、DB类、Image类...)、设计模式(mvc、单例、AR..)等。 以后使用框架开发项目只需要写业务代码即可。 现在企业中开发模式基本有三种: 从快到慢排序：二次开发(需要修改源码)---&amp;gt;==框架开">
<meta name="keywords" content="Html,Javascript,CSS,PHP">
<meta property="og:type" content="article">
<meta property="og:title" content="TP5框架">
<meta property="og:url" content="http://blog.kuma8866.top/posts/1124976518/index.html">
<meta property="og:site_name" content="Kuma&#39;s Blog">
<meta property="og:description" content="==TP5第一天==一、框架概述1、什么是框架框架(Framework)，它是许多代码文件的集合，这些代码文件是程序结构的代码，不是业务代码，里面包含了许多函数、类库(分页类、验证码类、文件上传类、DB类、Image类...)、设计模式(mvc、单例、AR..)等。 以后使用框架开发项目只需要写业务代码即可。 现在企业中开发模式基本有三种: 从快到慢排序：二次开发(需要修改源码)---&amp;gt;==框架开">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image1.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image2.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image3.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image4.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image5.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image6.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image7.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image8.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image9.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image10.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image11.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image12.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image13.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image14.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image15.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image16.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image17.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image18.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image19.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image20.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image21.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image22.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/1534121418781.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image23.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image24.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image25.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image26.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image27.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image28.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image29.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image30.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image31.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image32.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image33.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image34.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image35.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image36.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image37.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image38.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image39.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image40.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image41.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image42.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image43.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image44.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image45.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image46.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image47.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image48.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image49.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image50.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image51.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image52.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image53.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image54.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image55.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image56.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image63.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image64.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image65.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image67.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image68.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image82.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image83.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image84.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image85.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image86.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image87.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image88.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image1.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image2.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image3.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image4.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image5.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image6.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image7.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image8.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image9.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image11.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image12.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image13.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image14.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image15.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image16.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image17.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image18.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image19.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image20.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image22.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image23.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image24.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image26.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image27.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image28.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image29.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image30.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image31.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image32.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image33.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image35.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image36.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image37.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image38.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media2/image34.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image1.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image2.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image3.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image4.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image5.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image9.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image10.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image11.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media3/image12.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image31.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image32.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image33.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image34.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image35.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image36.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image37.png">
<meta property="og:image" content="http://blog.kuma8866.top/posts/1124976518/media4/image38.png">
<meta property="og:updated_time" content="2019-02-28T04:36:17.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TP5框架">
<meta name="twitter:description" content="==TP5第一天==一、框架概述1、什么是框架框架(Framework)，它是许多代码文件的集合，这些代码文件是程序结构的代码，不是业务代码，里面包含了许多函数、类库(分页类、验证码类、文件上传类、DB类、Image类...)、设计模式(mvc、单例、AR..)等。 以后使用框架开发项目只需要写业务代码即可。 现在企业中开发模式基本有三种: 从快到慢排序：二次开发(需要修改源码)---&amp;gt;==框架开">
<meta name="twitter:image" content="http://blog.kuma8866.top/posts/1124976518/media1/image1.png">



  <link rel="alternate" href="/atom.xml" title="Kuma's Blog" type="application/atom+xml">




  <link rel="canonical" href="http://blog.kuma8866.top/posts/1124976518/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>TP5框架 | Kuma's Blog</title>
  






  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?bb5184da6d86a99b44651b67ec05e581";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Kuma's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Kuma桑の博客，Hexo强力驱动</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-commonweal">

    
    
    
      
    

    

    <a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>公益 404</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.kuma8866.top/posts/1124976518/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kuma">
      <meta itemprop="description" content="爱分享，爱技术，爱生活。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kuma's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">TP5框架
              
            
          </h2>
        

        <div class="post-meta">
		  
			<i class="fa fa-thumb-tack"></i>
			<font color="7D26CD">置顶</font>
			<span class="post-meta-divider">|</span>
		  
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-28 12:36:17" itemprop="dateCreated datePublished" datetime="2019-02-28T12:36:17+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Dev/" itemprop="url" rel="index"><span itemprop="name">Dev</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Dev/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Dev/PHP/ThinkPHP5框架/" itemprop="url" rel="index"><span itemprop="name">ThinkPHP5框架</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">29k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">27 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="TP5第一天"><a href="#TP5第一天" class="headerlink" title="==TP5第一天=="></a>==TP5第一天==</h1><h1 id="一、框架概述"><a href="#一、框架概述" class="headerlink" title="一、框架概述"></a>一、框架概述</h1><h2 id="1、什么是框架"><a href="#1、什么是框架" class="headerlink" title="1、什么是框架"></a>1、什么是框架</h2><p><strong>框架(Framework)</strong>，它是许多代码文件的集合，这些代码文件是程序结构的代码，不是业务代码，里面包含了许多函数、类库(分页类、验证码类、文件上传类、DB类、Image类...)、设计模式(mvc、单例、AR..)等。</p>
<p>以后使用框架开发项目只需要写业务代码即可。</p>
<p><strong>现在企业中开发模式基本有三种:</strong></p>
<p>从快到慢排序：二次开发(需要修改源码)--->==<strong>框架开发</strong>==---->源码开发</p>
<p><strong>源码建房子</strong>：从零开始->打地基->浇筑混泥土->装修.…</p>
<p><strong>框架建房子</strong>：相当于毛坯房->各种装修。</p>
<p><strong>二次开发建房子</strong>：相当于精装修的房子，只需要拎包入住。</p>
<p>现在企业开发较多的模式属框架开发。</p>
<h2 id="2、框架开发的好处"><a href="#2、框架开发的好处" class="headerlink" title="2、框架开发的好处"></a>2、框架开发的好处</h2><ul>
<li><p><strong>框架能节省开发时间</strong></p>
<p>每个项目中常用的类库框架都已经封装好，如分页类、图像类,文件上传类等，直接调用即可,非常方便。（减少重复造轮子）</p>
</li>
<li><p><strong>利于团队的合作开发</strong></p>
<p>因为框架都是mvc设计模式,模块划分清晰，可以帮助我们快速、稳定、高效搭建web应用，从而提高开发效率。</p>
</li>
<li><p><strong>使用框架的过程中可以使得我们的注意力全部集中在业务层面，而无需关心程序的底层架构。</strong></p>
</li>
</ul>
<h2 id="3、框架的设计模式-MVC"><a href="#3、框架的设计模式-MVC" class="headerlink" title="3、框架的设计模式(MVC)"></a>3、框架的设计模式(MVC)</h2><p>基本现在主流的框架(CI、TP、laravel、YII、zend framework、symfony、cakephp),都是采用<strong>单一入口</strong>(index.php)，且都是采用<strong>mvc</strong>的设计模式，把一个web应用程序分为三块,<strong>控制器</strong>、<strong>模型</strong>、<strong>视图</strong>。</p>
<p>C-Controller 控制器</p>
<p>主要作用:就是接收用户的请求,在模型和视图之间起一个调度的作用</p>
<p>M-Model 模型</p>
<p>作用:对数据库做增删改查(curd)的</p>
<p>V-View视图</p>
<p>展示模板内容,给用户一个可操作的界面</p>
<p><strong>mvc(框架)形象理解-酒店（难以理解的东西一定要把抽象的东西给生活化，助于理解）</strong></p>
<p><img src="media1/image1.png" alt=""></p>
<h2 id="4、常见的php开发框架"><a href="#4、常见的php开发框架" class="headerlink" title="4、常见的php开发框架"></a>4、常见的php开发框架</h2><h3 id="（1）ThinkPHP框架（TP框架）"><a href="#（1）ThinkPHP框架（TP框架）" class="headerlink" title="（1）ThinkPHP框架（TP框架）"></a>（1）ThinkPHP框架（TP框架）</h3><p>TP框架的logo：</p>
<p><img src="media1/image2.png" alt=""></p>
<p>主要开发中小型项目</p>
<p>ThinkPHP框架是我们国人开发采用mvc模式设计的一款比较优秀的框架。在我们国内使用量较多，且开发文档也多，方便学习。</p>
<h3 id="（2）CodeIgniter-框架"><a href="#（2）CodeIgniter-框架" class="headerlink" title="（2）CodeIgniter 框架"></a>（2）CodeIgniter 框架</h3><p>CodeIgniter框架：简称CI框架，主要开发中小型项目</p>
<p><img src="media1/image3.png" alt=""></p>
<h3 id="（3）YII-易框架"><a href="#（3）YII-易框架" class="headerlink" title="（3）YII(易框架)"></a>（3）YII(易框架)</h3><p>YII(简称易框架):主要开发大型的web应用程序:</p>
<p><img src="media1/image4.png" alt=""></p>
<h3 id="（4）Laravel框架"><a href="#（4）Laravel框架" class="headerlink" title="（4）Laravel框架"></a>（4）Laravel框架</h3><p>此框架使用量世界排名第一,有最优雅的框架称号。</p>
<p>注：Laravel底层代码很多都是借鉴了SymFony的优点。</p>
<p><img src="media1/image5.png" alt=""></p>
<h3 id="（5）Zend官方框架"><a href="#（5）Zend官方框架" class="headerlink" title="（5）Zend官方框架"></a>（5）Zend官方框架</h3><p>Zend Framework：php官方提供的框架，非常笨重，主要开发大型的web应用程序。</p>
<p><img src="media1/image6.png" alt=""></p>
<h3 id="（6）Symfony国外框架"><a href="#（6）Symfony国外框架" class="headerlink" title="（6）Symfony国外框架"></a>（6）Symfony国外框架</h3><p><img src="media1/image7.png" alt=""></p>
<p>==框架只有最合适的，没有最好的，需结合自己的实际业务去选择最合适的。==</p>
<p>国内使用较多的框架是<strong>TP</strong>、<strong>laravel</strong>、<strong>CI</strong>。</p>
<p><strong>YII</strong>，<strong>Symfony</strong>框架一般外企使用较多</p>
<hr>
<h1 id="二、ThinkPHP5框架"><a href="#二、ThinkPHP5框架" class="headerlink" title="二、ThinkPHP5框架"></a>二、ThinkPHP5框架</h1><h2 id="1、下载TP5框架"><a href="#1、下载TP5框架" class="headerlink" title="1、下载TP5框架"></a>1、下载TP5框架</h2><p>下载地址：<a href="http://www.thinkphp.cn/down.html" target="_blank" rel="noopener">http://www.thinkphp.cn/down.html</a></p>
<p><img src="media1/image8.png" alt=""></p>
<p><img src="media1/image9.png" alt=""></p>
<h2 id="2、TP5框架的目录结构"><a href="#2、TP5框架的目录结构" class="headerlink" title="2、TP5框架的目录结构"></a>2、TP5框架的目录结构</h2><p>手册位置：基础-->目录结构</p>
<p><img src="media1/image10.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">1.	project  应用部署目录</span><br><span class="line">2.	├─application           应用目录（可设置）</span><br><span class="line">3.	│  ├─common             公共模块目录（可更改）</span><br><span class="line">4.	│  ├─index              模块目录(可更改)</span><br><span class="line">5.	│  │  ├─config.php      模块配置文件</span><br><span class="line">6.	│  │  ├─common.php      模块函数文件</span><br><span class="line">7.	│  │  ├─controller      控制器目录</span><br><span class="line">8.	│  │  ├─model           模型目录</span><br><span class="line">9.	│  │  ├─view            视图目录</span><br><span class="line">10.	│  │  └─ ...            更多类库目录</span><br><span class="line">11.	│  ├─command.php        命令行工具配置文件</span><br><span class="line">12.	│  ├─common.php         应用公共（函数）文件</span><br><span class="line">13.	│  ├─config.php         应用（公共）配置文件</span><br><span class="line">14.	│  ├─database.php       数据库配置文件</span><br><span class="line">15.	│  ├─tags.php           应用行为扩展定义文件</span><br><span class="line">16.	│  └─route.php          路由配置文件</span><br><span class="line">17.	├─extend                扩展类库目录（可定义）</span><br><span class="line">18.	├─public                WEB 部署目录（对外访问目录）</span><br><span class="line">19.	│  ├─static             静态资源存放目录(css,js,image)</span><br><span class="line">20.	│  ├─index.php          应用入口文件</span><br><span class="line">21.	│  ├─router.php         快速测试文件</span><br><span class="line">22.	│  └─.htaccess          用于 apache 的重写</span><br><span class="line">23.	├─runtime               应用的运行时目录（可写，可设置）</span><br><span class="line">24.	├─vendor                第三方类库目录（Composer）</span><br><span class="line">25.	├─thinkphp              框架系统目录</span><br><span class="line">26.	│  ├─lang               语言包目录</span><br><span class="line">27.	│  ├─library            框架核心类库目录</span><br><span class="line">28.	│  │  ├─think           Think 类库包目录</span><br><span class="line">29.	│  │  └─traits          系统 Traits 目录</span><br><span class="line">30.	│  ├─tpl                系统模板目录</span><br><span class="line">31.	│  ├─.htaccess          用于 apache 的重写</span><br><span class="line">32.	│  ├─.travis.yml        CI 定义文件</span><br><span class="line">33.	│  ├─base.php           基础定义文件</span><br><span class="line">34.	│  ├─composer.json      composer 定义文件</span><br><span class="line">35.	│  ├─console.php        控制台入口文件</span><br><span class="line">36.	│  ├─convention.php     惯例配置文件</span><br><span class="line">37.	│  ├─helper.php         助手函数文件（可选）</span><br><span class="line">38.	│  ├─LICENSE.txt        授权说明文件</span><br><span class="line">39.	│  ├─phpunit.xml        单元测试配置文件</span><br><span class="line">40.	│  ├─README.md          README 文件</span><br><span class="line">41.	│  └─start.php          框架引导文件</span><br><span class="line">42.	├─build.php             自动生成定义文件（参考）</span><br><span class="line">43.	├─composer.json         composer 定义文件</span><br><span class="line">44.	├─LICENSE.txt           授权说明文件</span><br><span class="line">45.	├─README.md             README 文件</span><br><span class="line">46.	├─think                 命令行入口文件</span><br></pre></td></tr></table></figure>
<p>==重点目录：==</p>
<ul>
<li><p>应用<strong>application</strong>目录</p>
</li>
<li><p>框架的核心目录<strong>thinkphp</strong></p>
</li>
<li><p><strong>public</strong>目录供外访问的</p>
</li>
</ul>
<p>每个application下面的模块目录都有mvc分层结构，如index模块</p>
<p><img src="media1/image11.png" alt=""></p>
<p>当然也可以在application目录中创建多个模块（分组）。</p>
<hr>
<h1 id="三、使用TP5框架部署项目"><a href="#三、使用TP5框架部署项目" class="headerlink" title="三、使用TP5框架部署项目"></a>三、使用TP5框架部署项目</h1><p>我们是使用ThinkPHP5+JavaScipt+Ajax+jquery以及和第三方插件结合起来，做一个文章管理系统，掌握怎样使用ThinkPHP5快速开发一个项目。</p>
<h2 id="1、配置项目虚拟主机"><a href="#1、配置项目虚拟主机" class="headerlink" title="1、配置项目虚拟主机"></a>1、配置项目虚拟主机</h2><p><strong>主要三个核心步骤：</strong></p>
<ol>
<li><p>使用phpStudy建立虚拟主机，把tp5框架部署在web虚拟目录中</p>
</li>
<li><p>设置hosts文件ip和域名的映射</p>
</li>
<li><p>重启apache服务器</p>
</li>
</ol>
<p>步骤如下：</p>
<p><strong>步骤1</strong>：把下载下来的框架程序复制到web虚拟目录</p>
<p><img src="media1/image12.png" alt=""></p>
<p><strong>步骤2</strong>：使用phpstudy建立虚拟主机</p>
<p><img src="media1/image13.png" alt=""></p>
<p><img src="media1/image14.png" alt=""></p>
<p><img src="media1/image15.png" alt=""></p>
<p><img src="media1/image16.png" alt=""></p>
<p>==注：域名是绑定在项目的public目录下面==</p>
<p><strong>步骤3</strong>：设置hosts文件ip和域名的映射</p>
<p><img src="media1/image17.png" alt=""></p>
<h2 id="2、访问虚拟主机"><a href="#2、访问虚拟主机" class="headerlink" title="2、访问虚拟主机"></a>2、访问虚拟主机</h2><p>输入配置的域名直接访问：</p>
<p><img src="media1/image18.png" alt=""></p>
<p>为什么会出现上面的一个笑脸？</p>
<p>答：那是因为受到框架的应用配置文件<code>application/config.php</code>的影响，默认访问index模块的index控制器的index方法，如下：</p>
<p><img src="media1/image19.png" alt=""></p>
<p>注：tp5默认支持老本tp3的<strong>pathinfo</strong>模式进行访问。<br><code>http://域名/index.php/模块/控制器/方法名/参数1/值1/参数2/值2/</code></p>
<p>例：访问index模块的index 控制器的index方法</p>
<p><code>http://域名/index.php/index/index/index/参数1/值1/参数2/值2/</code></p>
<p>当然tp5框架也支持像laravel框架那样定义路由来访问。</p>
<h2 id="3、响应输出"><a href="#3、响应输出" class="headerlink" title="3、响应输出"></a>3、响应输出</h2><p>控制器的所有操作方法都是<code>return</code>返回而不是直接输出，系统会调用<code>Response::send</code>方法将最终的应用返回的数据输出到页面或者客户端，并自动转换成配置项<code>default_return_type</code>（默认为html）配置的格式。所以，应用执行的数据输出只需要返回一个正常的PHP数据即可。</p>
<p>tp5也是建议统一使用<code>return</code>返回数据，而不是<code>echo</code>输出，如非必要，请不要使用<code>exit</code>或者<code>die</code>中断执行。</p>
<p><img src="media1/image20.png" alt=""></p>
<hr>
<h1 id="四、控制器"><a href="#四、控制器" class="headerlink" title="四、控制器"></a>四、控制器</h1><h2 id="1、控制器的作用"><a href="#1、控制器的作用" class="headerlink" title="1、控制器的作用"></a>1、控制器的作用</h2><p>C：Controller</p>
<p>==作用==：主要是接受用户的请求，在模型和视图之间起调度的作用。</p>
<h2 id="2、创建控制器"><a href="#2、创建控制器" class="headerlink" title="2、创建控制器"></a>2、创建控制器</h2><h3 id="（1）修改控制器后缀"><a href="#（1）修改控制器后缀" class="headerlink" title="（1）修改控制器后缀"></a>（1）修改控制器后缀</h3><p>由于国人命名的习惯，一般控制器名称后面都习惯加<code>controller</code>，我们可以通过以下配置文件设置后缀。</p>
<p>打开配置文件，<code>[项目目录]/application/config.php</code>，做如下修改：</p>
<p><img src="media1/image21.png" alt=""></p>
<p>上面改好之后，控制器==文件的命名==和==控制器类名==都需要更改：</p>
<p><img src="media1/image22.png" alt=""></p>
<h5 id="important"><a href="#important" class="headerlink" title="!important"></a>!important</h5><p><strong>==注意： 不管是否修改，访问时都不能加后缀，因为默认会自动添加此后缀的。==</strong></p>
<p><img src="media1/1534121418781.png" alt="1534121418781"></p>
<h3 id="（2）创建控制器语法"><a href="#（2）创建控制器语法" class="headerlink" title="（2）创建控制器语法"></a>（2）创建控制器语法</h3><p><strong>==语法规则：==</strong></p>
<p><strong>控制器类名</strong>：控制器名（首字母大写）+Controlle<br><strong>控制器文件名</strong>：控制器名+Controller.php<br><strong>控制器文件所在路径</strong>：application/模块名/controller/</p>
<p>如在index模块下定义一个Test控制器：</p>
<p>控制器类名： <code>TestController</code></p>
<p>控制器类文件名：<code>TestController.php</code></p>
<p>文件定义位置：<code>index/controller/TestController.php</code></p>
<p>==注：类名首字母大写==</p>
<p>代码如下：</p>
<p><img src="media1/image23.png" alt=""></p>
<p>访问：<br><img src="media1/image24.png" alt=""></p>
<h3 id="（3）隐藏入口文件进行访问（rewrite重写模式）"><a href="#（3）隐藏入口文件进行访问（rewrite重写模式）" class="headerlink" title="（3）隐藏入口文件进行访问（rewrite重写模式）"></a>（3）隐藏入口文件进行访问（rewrite重写模式）</h3><p>省去<code>index.php</code>入口文件访问，需要以下几步。</p>
<ul>
<li><p>步骤1：在apache配置文件<code>httpd.conf</code>开启重写文件：</p>
<p><img src="media1/image25.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>步骤2：找到重写文件<code>.htaccess</code>，在<code>[项目根目录]/Public/.htaccess</code> ,做如下修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_rewrite.c&gt;</span><br><span class="line">  Options +FollowSymlinks -Multiviews</span><br><span class="line">  RewriteEngine On</span><br><span class="line"></span><br><span class="line">  RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">  RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">  RewriteRule ^(.*)$ index.php?/$1 [QSA,PT,L]</span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure>
<p><img src="media1/image26.png" alt=""></p>
<p>(==注==：上图可能需要在index.php后边加”?”号)</p>
</li>
</ul>
<ul>
<li><p><strong>步骤3</strong>：修改虚拟主机<code>httpd-vhosts.conf</code>的配置：加上<code>AllowOverride All</code>，默认phpstudy创建的虚拟主机自带这一行。</p>
<p><img src="media1/image27.png" alt=""></p>
<p>最后重启apache服务器，省去入口文件index.php进行访问，输入：<code>http://域名/模块/控制器/方法</code></p>
<p><img src="media1/image28.png" alt=""></p>
</li>
</ul>
<h3 id="（4）开启调试模式"><a href="#（4）开启调试模式" class="headerlink" title="（4）开启调试模式"></a>（4）开启调试模式</h3><p>为了在开发过程中，开发者能够及时看到详细的错误信息，我们在开发阶段可以把<code>application/config.php</code>配置文件中的<code>app_debug</code>配置项设置为<strong>true</strong>,</p>
<p><img src="media1/image29.png" alt=""></p>
<p>如访问一个不存在的方法indexdd,会报详细的错误，这样有利于错误的排查</p>
<p><img src="media1/image30.png" alt=""></p>
<p>在如：访问一个不存在的控制器，报错如下：</p>
<p><img src="media1/image31.png" alt=""></p>
<p>若设置为<code>app_debug</code>为<strong>false</strong>,则会出现友好的提示：</p>
<p><img src="media1/image32.png" alt=""></p>
<p>==所以，项目上线后，我们要把此配置改为<strong>false</strong>，不要让用户看到我们网站报错。==</p>
<hr>
<h1 id="五、项目分组-模块"><a href="#五、项目分组-模块" class="headerlink" title="五、项目分组(模块)"></a>五、项目分组(模块)</h1><h2 id="1、创建分组"><a href="#1、创建分组" class="headerlink" title="1、创建分组"></a>1、创建分组</h2><p>一个项目中一般都有<strong>Home</strong>、<strong>Admin</strong>分组，即前台和后台，那对应框架中就是一个具体的文件夹，每个项目文件夹都有对应的<strong>控制器</strong>、<strong>模型</strong>、<strong>视图</strong>对应的文件夹，tp5框架中默认有一个分组<strong>index</strong>。</p>
<p>我们只需要把<code>index</code>默认分组复制一份改名（如<code>admin</code>）放在<strong>Application</strong>目录下即可，同时修改对应类所在分组的命名空间即可。</p>
<p><img src="media1/image33.png" alt=""></p>
<p>在admin模块下面要建立一个<strong>控制器</strong>、<strong>模型</strong>、<strong>视图</strong>对应的文件夹，和一个<strong>配置文件</strong>和<strong>公共函数文件</strong></p>
<p><img src="media1/image34.png" alt=""></p>
<p>复制分组的时候，记得更改类名所在的模块命名空间：</p>
<p><img src="media1/image35.png" alt=""></p>
<h2 id="2、默认分组的设置"><a href="#2、默认分组的设置" class="headerlink" title="2、默认分组的设置"></a>2、默认分组的设置</h2><p>需修改框架的<code>application/config.php</code>配置文件，如设置默认访问admin分组的index控制器的index方法，做如下修改：</p>
<p><img src="media1/image36.png" alt=""></p>
<p>再次输入域名访问，访问的则是admin模块下的index控制器的index方法：</p>
<p><img src="media1/image37.png" alt=""></p>
<h2 id="3、分组的访问权限控制"><a href="#3、分组的访问权限控制" class="headerlink" title="3、分组的访问权限控制"></a>3、分组的访问权限控制</h2><p>有些分组若不想让用户访问，可以设置为禁止访问。需修改框架的<code>application/config.php</code>的配置文件：</p>
<p><img src="media1/image38.png" alt=""></p>
<p>上图是设置禁止访问common和index分组。</p>
<p>再次访问禁止的index模块，会报错，模块不存在。</p>
<p><img src="media1/image39.png" alt=""></p>
<h1 id="六、命令行操作-了解"><a href="#六、命令行操作-了解" class="headerlink" title="六、命令行操作(了解)"></a>六、命令行操作(了解)</h1><p>手册位置： 命令行–&gt;自动生成目录结构</p>
<h2 id="1、命令行创建分组"><a href="#1、命令行创建分组" class="headerlink" title="1、命令行创建分组"></a>1、命令行创建分组</h2><p>自动生成以<code>APP_PATH</code>为起始目录，并且会自动生成模块的默认的Index访问控制器文件用于显示框架的欢迎页面。</p>
<ul>
<li><code>__dir__</code> 表示生成目录（支持多级目录）</li>
<li><code>__file__</code> 表示生成文件（不定义默认会生成 config.php 文件）</li>
<li><code>controller</code> 表示生成<strong>controller</strong>类</li>
<li><code>model</code>  表示生成<strong>model</strong>类</li>
<li><code>view</code>  表示生成<strong>html</strong>文件（支持子目录）</li>
</ul>
<p>创建文件<code>application/build.php</code>并填充内容，可以参考根目录<code>build.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="comment">// 生成应用公共文件，位于 application 目录下</span></span><br><span class="line">    <span class="string">'__file__'</span> =&gt; [<span class="string">'common.php'</span>, <span class="string">'config.php'</span>, <span class="string">'database.php'</span>],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义demo模块的自动生成</span></span><br><span class="line">    <span class="comment">// '模块名'=&gt; [&lt;模块下的内容，可空&gt;]</span></span><br><span class="line">    <span class="string">'demo'</span> =&gt; [</span><br><span class="line">        <span class="comment">//创建文件，直接位于模块名目录下</span></span><br><span class="line">        <span class="string">'__file__'</span> =&gt; [<span class="string">'common.php'</span>],   </span><br><span class="line">        <span class="comment">//创建目录，直接位于模块名目录下</span></span><br><span class="line">        <span class="string">'__dir__'</span> =&gt; [<span class="string">'behavior'</span>, <span class="string">'controller'</span>, <span class="string">'model'</span>, <span class="string">'view'</span>],  </span><br><span class="line">        </span><br><span class="line">        <span class="comment">############### 对上面的目录进一步构建 ###############</span></span><br><span class="line">        <span class="comment">//创建的控制器目录下的内容（控制器文件及控制器类）</span></span><br><span class="line">        <span class="string">'controller'</span> =&gt; [<span class="string">'Index'</span>, <span class="string">'Test'</span>, <span class="string">'UserType'</span>],  </span><br><span class="line">        <span class="comment">//创建模型目录下的内容（文件及模型类）</span></span><br><span class="line">        <span class="string">'model'</span> =&gt; [], </span><br><span class="line">        <span class="comment">//创建视图目录下的内容（模版文件，不需要加后缀，默认html后缀）</span></span><br><span class="line">        <span class="string">'view'</span> =&gt; [<span class="string">'index/index'</span>], <span class="comment">//相当于 view/index/index.html</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// …… 其他更多的模块定义</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h5 id="important-1"><a href="#important-1" class="headerlink" title="!important"></a>!important</h5><p><strong>注意</strong>：模版文件，不需要加后缀，默认html后缀。控制器等==后缀不会自动添加==。已存在的不受影响</p>
<p>创建<code>application/build.php</code>并填充如下内容：</p>
<p><img src="media1/image40.png" alt=""></p>
<p>cmd切换到<strong>项目目录</strong>执行如下命令(需要添加php到环境变量)：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php think build</span><br></pre></td></tr></table></figure>
<p>成功后，会生成对应设置的模块、控制器、模型和文件等</p>
<h2 id="2、命令行创建控制器"><a href="#2、命令行创建控制器" class="headerlink" title="2、命令行创建控制器"></a>2、命令行创建控制器</h2><p>同样，cmd切换到<strong>项目目录</strong>执行如下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php think make:controller 分组/控制器名称</span><br></pre></td></tr></table></figure></p>
<h5 id="important-2"><a href="#important-2" class="headerlink" title="!important"></a>!important</h5><p><strong>注</strong>：不写分组名会直接创建在<code>common</code>分组 <code>controller</code>中，<code>控制器名称</code>==不需要写后缀==，自动添加后缀的。</p>
<p>例：在admin模块中生成一个User的控制器</p>
<p>项目根目录> php think make:controller admin/User</p>
<p>成功会提示successfully。</p>
<p>生成如下所示：</p>
<p><img src="media1/image41.png" alt=""></p>
<p>例如下述，要在index分组下创建UserController.php控制器文件</p>
<p>[项目根目录] > php think make:controller index/User</p>
<p>生成的文件：</p>
<p><img src="media1/image42.png" alt=""></p>
<h2 id="3、命令行创建模型类"><a href="#3、命令行创建模型类" class="headerlink" title="3、命令行创建模型类"></a>3、命令行创建模型类</h2><p>同样，cmd切换到<strong>项目目录</strong>执行如下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php think make:model 分组/模型名称</span><br></pre></td></tr></table></figure></p>
<p><strong>注</strong>： <code>模型名称</code>  后面并不会有自动添加的后缀</p>
<p>如，执行下面的指令可以生成<code>index</code>模块的<code>Blog</code>模型类库文件</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php think make:model index/Blog</span><br></pre></td></tr></table></figure>
<p>生成的模型类文件如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Blog</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="七、路由（重要）"><a href="#七、路由（重要）" class="headerlink" title="七、路由（重要）"></a>七、路由（重要）</h1><p>我们之前是通过<code>pathInfo</code>模式进行访问控制器中的方法,但是这种访问模式url太长，难以记住，能不能通过简单的地址就可以访问？,可以的！，通过tp5提供的路由就可以实现。</p>
<h2 id="1、路由模式"><a href="#1、路由模式" class="headerlink" title="1、路由模式"></a>1、路由模式</h2><p>手册位置：路由->路由模式</p>
<p>在tp5中，路由模式有三种，分别是：</p>
<ul>
<li>普通模式（默认模式pathinfo）</li>
<li>混合模式</li>
<li>强制模式</li>
</ul>
<h3 id="（1）普通模式"><a href="#（1）普通模式" class="headerlink" title="（1）普通模式"></a>（1）普通模式</h3><p>此模式是框架的默认模式，默认是关闭路由的。在<code>appcation/config.php</code>文件中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;url_route_on&apos;  =&gt;  false,</span><br></pre></td></tr></table></figure></p>
<p>上面路由关闭后，不会解析任何的路由规则，只能采用默认的pathInfo模式访问url。如：</p>
<p>http:/域名/index.php/模块/控制器/方法/参数1/值1</p>
<h3 id="（2）混合模式"><a href="#（2）混合模式" class="headerlink" title="（2）混合模式"></a>（2）混合模式</h3><p>开启路由，并使用路由定义+默认pathInfo模式的混合。在<code>appcation/config.php</code>文件中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&apos;url_route_on&apos;  =&gt;  true,</span><br><span class="line">&apos;url_route_must&apos;=&gt;  false,</span><br></pre></td></tr></table></figure></p>
<p>在<code>application/config.php</code>配置文件中开启路由功能后，访问的时候就会经过路由规则，根据定义的路由规则从而访问到某个控制器中的方法。</p>
<p>路由图解：</p>
<p><img src="media1/image43.png" alt=""></p>
<h3 id="（3）强制模式"><a href="#（3）强制模式" class="headerlink" title="（3）强制模式"></a>（3）强制模式</h3><p>开启路由，并设置必须定义路由才能访问。在<code>appcation/config.php</code>文件中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&apos;url_route_on&apos;  =&gt;  true,</span><br><span class="line">&apos;url_route_must&apos;=&gt;  true,</span><br></pre></td></tr></table></figure></p>
<p><strong>注</strong>：这种方式下面必须严格给每一个访问地址定义路由规则（包括首页），否则将抛出异常。</p>
<p>==推荐使用强制模式，方便后面url统一管理。==</p>
<h2 id="2、定义路由"><a href="#2、定义路由" class="headerlink" title="2、定义路由"></a>2、定义路由</h2><p>手册位置：路由->路由定义</p>
<p>把路由规则定义在<code>application/route.php</code>文件中。</p>
<p>需要先引入路由类<code>Route</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Route</span>;</span><br></pre></td></tr></table></figure></p>
<p><strong>==最简洁的定义方式如下：==</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Route::get(<span class="string">'路由表达式'</span>,<span class="string">'路由地址'</span>);</span><br><span class="line">Route::post(<span class="string">'路由表达式'</span>,<span class="string">'路由地址'</span>);</span><br><span class="line">Route::any(<span class="string">'路由表达式'</span>,<span class="string">'路由地址'</span>);</span><br><span class="line">或</span><br><span class="line">Route::Rule(<span class="string">'路由表达式'</span>,<span class="string">'路由地址'</span>,[<span class="string">'method'</span>=&gt;<span class="string">'get'</span>]);</span><br><span class="line"></span><br><span class="line">其中any代表任意请求方式（get/post）都支持的路由规则</span><br></pre></td></tr></table></figure>
<p><strong>例如</strong>：</p>
<p><code>Route::get(&#39;login&#39;,&#39;home/User/login&#39;);</code></p>
<p>访问：<a href="http://域名/index.php/login" target="_blank" rel="noopener">http://域名/index.php/login</a></p>
<p>路由到：<a href="http://域名/index.php/home/User/login" target="_blank" rel="noopener">http://域名/index.php/home/User/login</a></p>
<p><code>Route::get(&#39;houtai&#39;,&#39;admin/index/index&#39;);</code></p>
<p>访问：<a href="http://域名/houtai" target="_blank" rel="noopener">http://域名/houtai</a></p>
<p>路由到：<a href="http://域名/admin/index/index" target="_blank" rel="noopener">http://域名/admin/index/index</a></p>
<p>如下的一个控制器<strong>login</strong>方法：</p>
<p><img src="media1/image44.png" alt=""></p>
<p>定义路由访问：</p>
<p><img src="media1/image45.png" alt=""></p>
<p>效果：</p>
<p><img src="media1/image46.png" alt=""></p>
<h2 id="3、定义路由分组"><a href="#3、定义路由分组" class="headerlink" title="3、定义路由分组"></a>3、定义路由分组</h2><p>一般前台的路由地址都含有<strong>home</strong>,后台则为<strong>admin</strong>,我们可以把相同的路由地址进行分组。</p>
<p><strong>路由分组语法：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Route::group(<span class="string">'分组名'</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">Route::get(<span class="string">'路由表达式'</span>,<span class="string">'路由地址'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>分组名</code> 只适用于 <code>路由表达式</code>，<code>路由地址</code>还是需要完整书写。</p>
<p>例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Route::group(<span class="string">'admin'</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">Route::any(<span class="string">'user/index'</span>,<span class="string">'admin/user/index);</span></span><br><span class="line"><span class="string">//定义更多...</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>
<p>访问：<a href="http://域名/admin/user/index" target="_blank" rel="noopener">http://域名/admin/user/index</a></p>
<p>路由到：<a href="http://域名/admin/user/index" target="_blank" rel="noopener">http://域名/admin/user/index</a></p>
<p>代码如下：</p>
<p><img src="media1/image47.png" alt=""></p>
<p>定义路由：</p>
<p><img src="media1/image48.png" alt=""></p>
<p>访问路由：</p>
<p><img src="media1/image49.png" alt=""></p>
<h2 id="4、定义路由参数-路由参数绑定"><a href="#4、定义路由参数-路由参数绑定" class="headerlink" title="4、定义路由参数(路由参数绑定)"></a>4、定义路由参数(路由参数绑定)</h2><h3 id="（1）定义单个路由参数"><a href="#（1）定义单个路由参数" class="headerlink" title="（1）定义单个路由参数"></a>（1）定义单个路由参数</h3><p>【<strong>==定义==</strong>】在路由表达式后面通过<code>:参数名</code>形式定义路由参数，<code>/</code>为参数分割符。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Route::get(<span class="string">"user/:id"</span>,<span class="string">'admin/test/test);</span></span><br></pre></td></tr></table></figure>
<p>【<strong>==传递==</strong>】在url中传递参数方式为<code>http://域名/user/34</code> ，注意，直接写参数的值即可，如34。</p>
<p>【<strong>==接收==</strong>】上面对应路由规则方法，必须定义一个==相同形参名==id来接收，如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">($id)</span></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若路由参数<strong>可缺省</strong>，则在路由表达式通过<code>[:参数名]</code> 来指定，同样用<code>/</code>为参数分割符。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Route::get(<span class="string">"user/[:id]"</span>,<span class="string">'admin/test/test'</span>);</span><br></pre></td></tr></table></figure>
<p>上面参数可缺省，且定义的\$id参数必须有<strong>默认值</strong>，否则报错</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">($id = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="（2）定义多个路由参数"><a href="#（2）定义多个路由参数" class="headerlink" title="（2）定义多个路由参数"></a>（2）定义多个路由参数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Route::get(<span class="string">"user/:id/:name/:email"</span>,<span class="string">'admin/test/test'</span>);</span><br></pre></td></tr></table></figure>
<p>则对应的形参名也必须一致，如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">($id,$name,$email)</span></span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> $id.$name.$email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="八、输出视图-模版"><a href="#八、输出视图-模版" class="headerlink" title="八、输出视图(模版)"></a>八、输出视图(模版)</h1><p><strong>输出视图</strong>（==渲染模版==）</p>
<p><strong>语法</strong>：控制器中调用fetch方法，常用写法，支持跨模块：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span> -&gt; fetch(模块@控制器/操作);</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<p>==控制器要调用fetch方法，则必须继承Controller类==：<code>use think\Controller</code></p>
<p><strong>fetch()一般下述3种用法：</strong></p>
<ul>
<li><p>[重点掌握]调用：<code>view目录下/当前控制器名同名目录/当前操作名.html</code>同名模板文件</p>
<p><code>return $this -&gt; fetch();</code></p>
</li>
<li><p>调用：<code>view目录下/当前控制器/add.html</code>模板文件</p>
<p><code>return $this -&gt; fetch(&#39;add&#39;);</code></p>
</li>
<li><p>调用：<code>view目录下/user控制器/login.html</code>模板文件[跨控制器]</p>
<p><code>return $this -&gt; fetch(&#39;user/login&#39;);</code></p>
</li>
</ul>
<pre><code>代码如下：
</code></pre><ol>
<li><p>控制器输出模板内容</p>
<p><img src="media1/image50.png" alt=""></p>
<p>定义好路由（<code>application/route.php</code>）：</p>
<p><code>Route::get(&#39;login/[:id]/[:name]&#39;,&#39;admin/user/login&#39;);</code></p>
</li>
<li><p>建立对应的模板文件：</p>
<p><img src="media1/image51.png" alt=""></p>
<p>效果：</p>
<p><img src="media1/image52.png" alt=""></p>
</li>
</ol>
<hr>
<h1 id="九、模板分配变量"><a href="#九、模板分配变量" class="headerlink" title="九、模板分配变量"></a>九、模板分配变量</h1><p><strong>==语法==</strong>：在控制器调用<code>assign</code>方法<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="comment">// 模板变量赋值</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;assign(<span class="string">'name'</span>,<span class="string">'ThinkPHP'</span>);</span><br><span class="line">       <span class="keyword">$this</span>-&gt;assign(<span class="string">'email'</span>,<span class="string">'thinkphp@qq.com'</span>);</span><br><span class="line">       <span class="comment">// 或者批量赋值</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;assign([</span><br><span class="line">           <span class="string">'name'</span>  =&gt; <span class="string">'ThinkPHP'</span>,</span><br><span class="line">           <span class="string">'email'</span> =&gt; <span class="string">'thinkphp@qq.com'</span></span><br><span class="line">       ]);</span><br><span class="line">       <span class="comment">// 模板输出</span></span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch(<span class="string">'index'</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>【推荐】或者把模板变量直接传递给fetch方法第二个数组参数：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch(<span class="string">'index'</span>, [</span><br><span class="line">            <span class="string">'name'</span>  =&gt; <span class="string">'ThinkPHP'</span>,</span><br><span class="line">            <span class="string">'email'</span> =&gt; <span class="string">'thinkphp@qq.com'</span></span><br><span class="line">        ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>代码如下：</p>
<p><img src="media1/image53.png" alt=""></p>
<p>在模板中默认通过一对花括号{ }，里面写分配过来的变量。</p>
<p><img src="media1/image54.png" alt=""></p>
<p>效果：<br><img src="media1/image55.png" alt=""></p>
<hr>
<h1 id="十、修改模版的定界符"><a href="#十、修改模版的定界符" class="headerlink" title="十、修改模版的定界符"></a>十、修改模版的定界符</h1><p>注意：默认模板变量的边界符是一对{}，可以通过以下配置进行修改，<code>application/config.php</code></p>
<p><img src="media1/image56.png" alt=""></p>
<hr>
<h1 id="十一、模板常用标签"><a href="#十一、模板常用标签" class="headerlink" title="十一、模板常用标签"></a>十一、模板常用标签</h1><p>手册位置： 模版–&gt;内置标签</p>
<h2 id="1、volist和foreach"><a href="#1、volist和foreach" class="headerlink" title="1、volist和foreach"></a>1、volist和foreach</h2><p><strong>作用</strong>：都是主要用来遍历数组</p>
<ul>
<li><p><strong>volist标签</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;volist name=<span class="string">"list"</span> id=<span class="string">"vo"</span>&#125;</span><br><span class="line">&#123;$vo.id&#125;:&#123;$vo.name&#125;&lt;br/&gt;</span><br><span class="line">&#123;/volist&#125;</span><br></pre></td></tr></table></figure>
<p>Volist标签的<strong>name</strong>属性表示模板赋值的变量名称，因此不可随意在模板文件中改变。<strong>id</strong>表示当前的循环变量，可以随意指定，但确保不要和name属性值冲突。</p>
</li>
</ul>
<ul>
<li><p><strong>foreach标签</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">foreach</span> name=<span class="string">"list"</span> item=<span class="string">"vo"</span>&#125;</span><br><span class="line">    &#123;$vo.id&#125;:&#123;$vo.name&#125;</span><br><span class="line">&#123;/<span class="keyword">foreach</span>&#125;</span><br></pre></td></tr></table></figure>
<p>name表示数据源 item表示循环变量。</p>
</li>
</ul>
<pre><code>代码如下：

控制器分配变量：

![](media1/image59.png)

模板输出变量：

![](media1/image60.png)

效果：

![](media1/image61.png)
</code></pre><h2 id="2、php标签"><a href="#2、php标签" class="headerlink" title="2、php标签"></a>2、php标签</h2><p>如果模板标签语法很难记，这里可以使用php标签统一进行一些代码的编写：</p>
<p>Php代码可以和标签在模板文件中混合使用，可以在模板文件里面书写任意的PHP语句代码 ，包括下面两种方式：</p>
<p><strong>使用php标签</strong></p>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;php&#125;echo 'Hello,world!';&#123;/php&#125;</span><br></pre></td></tr></table></figure>
<p>我们建议需要使用PHP代码的时候尽量采用php标签，因为原生的PHP语法可能会被配置禁用而导致解析错误。</p>
<p><strong>使用原生php代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo &apos;Hello,world!&apos;; ?&gt;</span><br></pre></td></tr></table></figure>
<p>注意：在php标签和原生的php中，可以自定义变量，同时也可以使用控制器分配过来的变量。</p>
<p><img src="media1/image63.png" alt=""></p>
<p>效果：</p>
<p><img src="media1/image64.png" alt=""></p>
<p>注：上面的原生php写法，可以通过配置文件进行禁用</p>
<p><img src="media1/image65.png" alt=""></p>
<h2 id="3、include标签"><a href="#3、include标签" class="headerlink" title="3、include标签"></a>3、include标签</h2><p><strong>作用</strong>：</p>
<p>一般网站页面的头部或尾部的网页效果都是一样的，我们就可以把这些网页的代码抽离出来放在一个html文件中，需要使用这些文件的时候，在模板中用include标签引入即可，从而<strong>提高代码的复用性</strong>。</p>
<p><strong>语法：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">include</span> file=<span class="string">'模版文件1,模版文件2,...'</span> /&#125;</span><br></pre></td></tr></table></figure>
<p><strong>使用模版表达式</strong></p>
<p>模版表达式的定义规则为：<strong>模块@控制器/操作</strong></p>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;include file="public/header" /&#125; // 包含头部模版header</span><br><span class="line">&#123;include file="public/menu" /&#125; // 包含菜单模版menu</span><br><span class="line">&#123;include file="blue/public/menu" /&#125; // 包含blue主题下面的menu模版</span><br></pre></td></tr></table></figure>
<p>可以一次包含多个模版，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;include file=&quot;public/header,public/menu&quot; /&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，包含模版文件并不会自动调用控制器的方法，也就是说包含的其他模版文件中的变量赋值需要在当前操作中完成。</p>
</blockquote>
<p>==注意：file的路径是从当前模块的view目录下开始找起。==</p>
<p>更多参考手册</p>
<p>如：有一个<code>header.html</code>模板，其所在路径为：<code>admin/view/public/header.html</code></p>
<p>在模板中引入此文件： <code>{include file=&quot;public/header&quot; /}</code></p>
<p><img src="media1/image67.png" alt=""><br>效果：</p>
<p><img src="media1/image68.png" alt=""></p>
<hr>
<h1 id="十二、助手函数"><a href="#十二、助手函数" class="headerlink" title="十二、助手函数"></a>十二、助手函数</h1><h2 id="1、url"><a href="#1、url" class="headerlink" title="1、url()"></a>1、url()</h2><p>手册位置：路由->URL生成。</p>
<p><strong>语法</strong>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">'模块/控制器/方法'</span>，参数);</span><br></pre></td></tr></table></figure>
<p><strong>作用</strong>：会生成指定的url地址，第二个参数指定跳转携带的参数，若在模板中使用助手函数需要在花括号{}前面加个冒号：，如 <code>{:url()}</code></p>
<p><code>&lt;a href=&quot;{:url(&#39;index/index/index&#39;,[&#39;id&#39;=&gt;1])}&quot;&gt;跳转&lt;/a&gt;</code></p>
<p>注:如果路由模式为强制模式，则url中的第一个参数只能是定义的路由规则。</p>
<p>更多的助手函数,手册位置：附录->助手函数</p>
<h2 id="2、config"><a href="#2、config" class="headerlink" title="2、config()"></a>2、config()</h2><p><strong>语法</strong>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config(<span class="string">'配置名'</span>,[值]);</span><br></pre></td></tr></table></figure>
<p><strong>作用</strong>：获取和设置配置文件中的值。</p>
<p>传递第一个参数就是获取。</p>
<p>传递第二个参数就是设置。</p>
<p>注意：</p>
<p><strong>配置文件的优先级（==就近原则==）</strong>：</p>
<p>动态配置(<code>config()</code>) > 模块配置(<code>admin/config.php</code>) >应用配置(<code>application/config.php</code>) > 惯例配置（核心配置<code>thinkphp/convention.php</code>）</p>
<h2 id="3、dump-和halt"><a href="#3、dump-和halt" class="headerlink" title="3、dump()和halt()"></a>3、dump()和halt()</h2><p>这是两个调试变量的函数：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dump($data)</span><br></pre></td></tr></table></figure>
<p><code>dump()</code>函数等价<code>&lt;pre /&gt; + var_dump()</code></p>
<p>而halt函数会停止代码的执行。<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">halt($data)</span><br></pre></td></tr></table></figure></p>
<p><code>halt()</code>函数等价<code>&lt;pre /&gt; + var_dump()+die;</code></p>
<hr>
<h1 id="十三、Request对象"><a href="#十三、Request对象" class="headerlink" title="十三、Request对象"></a>十三、Request对象</h1><p>手册位置：请求-->请求信息</p>
<h2 id="1、获取Request对象"><a href="#1、获取Request对象" class="headerlink" title="1、获取Request对象"></a>1、获取Request对象</h2><p>图解Request对象、response对象：</p>
<p><img src="media1/image82.png" alt=""></p>
<p>图解说明：</p>
<ul>
<li><p>服务端server把客户端请求过来的相关信息都封装在一个<strong>Request</strong>对象中。如请求地址、请求参数、请求类型、上传的文件信息等。</p>
</li>
<li><p>服务端server把响应给浏览器的相关信息都封装在一个<strong>Response</strong>对象。如响应http状态码200给客户端等。</p>
</li>
</ul>
<p><strong>获取Request对象的方式：</strong></p>
<p>方式一：</p>
<p>引用<code>think\Request</code>类 ，<code>$request = Request::instance();</code></p>
<p><img src="media1/image83.png" alt=""></p>
<p>方式二（最简单的方式）：</p>
<p>通过tp5框架提供的助手函数<code>request()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$request = request();</span><br></pre></td></tr></table></figure>
<p><img src="media1/image84.png" alt=""></p>
<p>方式三：通过依赖注入（闭包）的方式，把Request对象注入到方法内部</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(Request $request)</span></span>&#123;  <span class="comment">//声明参数类型</span></span><br><span class="line">	dump($request);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="media1/image85.png" alt=""></p>
<p>更多的助手函数在手册： 附录->助手函数</p>
<p>所有的助手函数源码位置：<code>thinkphp/helper.php</code></p>
<h2 id="2、获取请求信息"><a href="#2、获取请求信息" class="headerlink" title="2、获取请求信息"></a>2、获取请求信息</h2><p>手册参考位置：请求-->请求信息</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$request-&gt;domain();     <span class="comment">// 获取当前域名</span></span><br><span class="line">$request-&gt;url();         <span class="comment">// 获取当前URL地址</span></span><br><span class="line">$request-&gt;url(<span class="keyword">true</span>);    <span class="comment">// 包含域名的完整URL地址</span></span><br><span class="line">$request-&gt;baseUrl();    <span class="comment">// 获取当前URL地址 不含QUERY_STRING</span></span><br><span class="line">$request-&gt;header();     <span class="comment">// 获取当前请求的HTTP 请求头信息</span></span><br><span class="line">$request-&gt;ip();          <span class="comment">// 获取访问ip地址 </span></span><br><span class="line"></span><br><span class="line">$request-&gt;module();      <span class="comment">//获取当前访问模块名称</span></span><br><span class="line">$request-&gt;controller(); <span class="comment">//获取当前访问控制器名称</span></span><br><span class="line">$request-&gt;action();     <span class="comment">//获取当前访问操作名称 </span></span><br><span class="line">$request-&gt;isAjax();     <span class="comment">// 判断 是否是ajax请求</span></span><br><span class="line">$request-&gt;isPost();     <span class="comment">// 判断 是否是post请求</span></span><br><span class="line">$request-&gt;isGet();     <span class="comment">// 判断 是否是get请求</span></span><br></pre></td></tr></table></figure>
<p>代码：</p>
<p><img src="media1/image86.png" alt=""></p>
<p>效果：<br><img src="media1/image87.png" alt=""></p>
<h2 id="3、获取请求参数"><a href="#3、获取请求参数" class="headerlink" title="3、获取请求参数"></a>3、获取请求参数</h2><p>手册参考位置：请求-->输入变量</p>
<p><strong>语法</strong>：<code>变量类型方法(&#39;变量名/变量修饰符&#39;,&#39;默认值&#39;,&#39;过滤方法&#39;)</code></p>
<h3 id="（1）获取GET和POST参数"><a href="#（1）获取GET和POST参数" class="headerlink" title="（1）获取GET和POST参数"></a>（1）获取GET和POST参数</h3><p>==注：input()会自动获取get或post传递的参数==</p>
<p>这里推荐使用内置的助手函数<code>input()</code>可以获取到get或post参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">input(<span class="string">'id'</span>); <span class="comment">// 接收id参数</span></span><br><span class="line">input(<span class="string">'name'</span>);<span class="comment">// 接收name参数</span></span><br><span class="line">input(<span class="string">'get.'</span>); <span class="comment">//获取整个get数组参数</span></span><br><span class="line">input(<span class="string">'post.'</span>); <span class="comment">//获取整个post数组参数</span></span><br></pre></td></tr></table></figure>
<p>如果要获取的数据为数组的时候，一定要加<code>/a</code>修饰符才能正确获取到。</p>
<p>如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">name</span>=<span class="string">'ids[]'</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>接收ids参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input(<span class="string">'ids/a'</span>); <span class="comment">// 接收ids数组参数</span></span><br></pre></td></tr></table></figure>
<p>tp5框架默认的修饰符为<code>/s</code>,如果传入字符串之外的变量可以使用下面的修饰符，包括：</p>
<ul>
<li><p><code>/s</code>  强制转换为字符串类型</p>
</li>
<li><p><code>/d</code> 强制转换为整型类型</p>
</li>
<li><p><code>/b</code>  强制转换为布尔类型</p>
</li>
<li><p><code>/a</code>  强制转换为数组类型</p>
</li>
<li><p><code>/f</code> 强制转换为浮点类型</p>
</li>
</ul>
<p>代码如下：</p>
<p><img src="media1/image88.png" alt=""></p>
<p>注：input函数底层默认默认采用PARAM方式进行读取变量，自动识别GET或POST提交的参数。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前请求的name变量</span></span><br><span class="line">$request-&gt;param(<span class="string">'name'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="（2）参数默认值"><a href="#（2）参数默认值" class="headerlink" title="（2）参数默认值"></a>（2）参数默认值</h3><p>说明：当参数没有值的时候，可以在input的第二个参数设置其默认值。</p>
<p>如，当参数id没有值时候，设置默认值为0</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input(<span class="string">'id'</span>,<span class="number">0</span>); <span class="comment">// 接收id参数</span></span><br></pre></td></tr></table></figure>
<h3 id="（3）参数过滤"><a href="#（3）参数过滤" class="headerlink" title="（3）参数过滤"></a>（3）参数过滤</h3><p>我们对接收到的参数往往需要对其做一些过滤处理，如下几个常用过滤方法：</p>
<ul>
<li><p><strong>strip_tags</strong> :去除字符串的html和php标记</p>
</li>
<li><p><strong>strtolower</strong> : 转化为小写</p>
</li>
<li><p><strong>htmlspecialchars</strong>：把html标签转化为html实体符号（防止xss（js）攻击）</p>
<p>如：大于号<code>&gt;</code>会被转化为 <code>&amp;gt;</code></p>
<p>如：大于号<code>&lt;</code>会被转化为 <code>&amp;lt;</code></p>
<p>.….</p>
</li>
</ul>
<p><strong>只需要在input的第三个参数设置相应的过滤函数即可。</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input(<span class="string">'name'</span>,<span class="string">''</span>,<span class="string">'htmlspecialchars'</span>); <span class="comment">// 接收name参数,默认为空，经过htmlspecialchars处理</span></span><br></pre></td></tr></table></figure>
<p><strong>也可以依次经过多个过滤函数处理：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input(<span class="string">'name'</span>,<span class="string">''</span>,<span class="string">'strip_tags,strtolower'</span>); <span class="comment">// 先去除标记，在转化为小写</span></span><br></pre></td></tr></table></figure>
<p>==注意：==</p>
<p>框架默认<strong>没有</strong>设置任何过滤规则，你可以在配置文件<code>application/config.php</code>中设置全局的过滤规则。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认全局过滤方法 用逗号分隔多个</span></span><br><span class="line"> <span class="string">'default_filter'</span>         =&gt; <span class="string">'htmlspecialchars'</span>,</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="TP5第二天"><a href="#TP5第二天" class="headerlink" title="==TP5第二天=="></a>==TP5第二天==</h1><h1 id="一、数据库操作"><a href="#一、数据库操作" class="headerlink" title="一、数据库操作"></a>一、数据库操作</h1><p>==<strong>在TP5操作数据库常用有两种方式：</strong>==</p>
<ul>
<li><p><strong>通过Db构造器</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如：Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'status'</span>,<span class="number">1</span>)-&gt;select(); <span class="comment">// #带数据表前缀</span></span><br><span class="line">如：Db::name(<span class="string">'user'</span>)-&gt;where(<span class="string">'status'</span>,<span class="number">1</span>)-&gt;select(); <span class="comment">#不带表前缀</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>通过模型类</strong></p>
<p>如：取出主键为1的数据(首先配置数据库的连接信息)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$user = User::get(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="1、创建数据库数据"><a href="#1、创建数据库数据" class="headerlink" title="1、创建数据库数据"></a>1、创建数据库数据</h2><p>创建好数据库和数据表：</p>
<ol>
<li><p>创建数据库article:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database article;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建数据表<strong>tp_user</strong>(用户表)、<strong>tp_category</strong>（分类表）、<strong>tp_article</strong>（文章表）</p>
<p><strong>tp_user表结构：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table tp_user(</span><br><span class="line">    user_id int not null auto_increment,</span><br><span class="line">    username varchar(30) not null default &apos;&apos; comment &apos;用户名&apos;,</span><br><span class="line">    password char(32) not null default &apos;&apos; comment &apos;密码&apos;,</span><br><span class="line">    primary key(user_id)</span><br><span class="line">)engine = Innodb default charset = utf8;</span><br></pre></td></tr></table></figure>
<p> <strong>tp_category表结构：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table tp_category(</span><br><span class="line">    cat_id smallint not null auto_increment,</span><br><span class="line">    cat_name varchar(30) not null default &apos;&apos; comment &apos;分类名称&apos;,</span><br><span class="line">    pid  smallint not null default 0 comment &apos;父分类的id&apos;,</span><br><span class="line">    create_time int not null default 0 comment &apos;创建时间&apos;,</span><br><span class="line">    update_time int not null default 0 comment &apos;更新时间&apos;,</span><br><span class="line">    primary key(cat_id)</span><br><span class="line">)engine = Innodb default charset = utf8;</span><br></pre></td></tr></table></figure>
<p><strong>tp_article表结构：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create table tp_article(</span><br><span class="line">	article_id smallint not null auto_increment,</span><br><span class="line">	title varchar(30) not null default &apos;&apos; comment &apos;文章标题&apos;,</span><br><span class="line">	content  text   comment &apos;文章内容&apos;,</span><br><span class="line">	cat_id smallint not null default 0  comment &apos;文章所属分类&apos;,</span><br><span class="line">	ori_img varchar(150) not null default &apos;&apos; comment &apos;原图的路径&apos;,</span><br><span class="line">	thumb_img varchar(150) not null default &apos;&apos; comment &apos;缩略图的路径&apos;,</span><br><span class="line">	create_time int not null default 0 comment &apos;创建时间&apos;,</span><br><span class="line">	update_time int not null default 0 comment &apos;更新时间&apos;,</span><br><span class="line">	primary key(article_id)</span><br><span class="line">)engine = Innodb default charset = utf8;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>==注：表名加前缀<code>tp_</code>，用于区分多个项目。==</p>
<p>可以向表添加几条模拟数据，方便后面进行查询</p>
<p><img src="media2/image1.png" alt=""></p>
<h2 id="2、配置数据库信息"><a href="#2、配置数据库信息" class="headerlink" title="2、配置数据库信息"></a>2、配置数据库信息</h2><p>在<code>application/database.php</code>文件中配置数据库相应参数（* 标记）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="comment">// 数据库类型</span></span><br><span class="line">    <span class="string">'type'</span>            =&gt; <span class="string">'mysql'</span>,</span><br><span class="line">    <span class="comment">// 服务器地址</span></span><br><span class="line">    <span class="string">'hostname'</span>        =&gt; <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="comment">// * 数据库名</span></span><br><span class="line">    <span class="string">'database'</span>        =&gt; <span class="string">'article'</span>,</span><br><span class="line">    <span class="comment">// * 用户名</span></span><br><span class="line">    <span class="string">'username'</span>        =&gt; <span class="string">'root'</span>,</span><br><span class="line">    <span class="comment">// * 密码</span></span><br><span class="line">    <span class="string">'password'</span>        =&gt; <span class="string">'root'</span>,</span><br><span class="line">    <span class="comment">// * 端口</span></span><br><span class="line">    <span class="string">'hostport'</span>        =&gt; <span class="string">'3306'</span>,</span><br><span class="line">    <span class="comment">// 连接dsn</span></span><br><span class="line">    <span class="string">'dsn'</span>             =&gt; <span class="string">''</span>,</span><br><span class="line">    <span class="comment">// 数据库连接参数</span></span><br><span class="line">    <span class="string">'params'</span>          =&gt; [],</span><br><span class="line">    <span class="comment">// 数据库编码默认采用utf8</span></span><br><span class="line">    <span class="string">'charset'</span>         =&gt; <span class="string">'utf8'</span>,</span><br><span class="line">    <span class="comment">// * 数据库表前缀</span></span><br><span class="line">    <span class="string">'prefix'</span>          =&gt; <span class="string">'tp_'</span>,</span><br></pre></td></tr></table></figure>
<h2 id="3、模型"><a href="#3、模型" class="headerlink" title="3、模型"></a>3、模型</h2><h3 id="（1）模型作用"><a href="#（1）模型作用" class="headerlink" title="（1）模型作用"></a>（1）模型作用</h3><p><strong>M:Model</strong>    模型</p>
<p><strong>作用</strong>：主要对数据库进行一些增删改查的操作。</p>
<h3 id="（2）模型的定义"><a href="#（2）模型的定义" class="headerlink" title="（2）模型的定义"></a>（2）模型的定义</h3><p>如文章分类表，名为<code>tp_category</code>，此表对应的模型类名和模型文件定义如下：</p>
<p><strong>模型类名</strong>： <code>Category</code>，驼峰法，除开表前缀的数据表名称。</p>
<p><strong>模型类文件</strong>： <code>Category.php</code>, 表名+.php</p>
<p><strong>模型类文件所在位置</strong>：<code>模块名/model/Category.php</code></p>
<p>给表<code>tp_category</code>建立模型文件如下：</p>
<p><img src="media2/image2.png" alt=""></p>
<p>其中模型中定义的属性<code>$pk</code>为表的主 键名称，若不指定则框架会自动识别。</p>
<p>==有关表名的注意事项：==</p>
<p>手册位置： 模型->定义</p>
<p><img src="media2/image3.png" alt=""></p>
<h3 id="（3）实例化模型"><a href="#（3）实例化模型" class="headerlink" title="（3）实例化模型"></a>（3）实例化模型</h3><ul>
<li><p><strong>方式一</strong>（==推荐==）：在控制器中实化模型首先引入其模型类所在的命名空间，如引入上面的<code>Category</code></p>
<p>控制器中引入：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">admin</span>\<span class="title">model</span>\<span class="title">Category</span>;</span><br></pre></td></tr></table></figure>
<p>然后实例化模型：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$catModel= <span class="keyword">new</span> Category();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>方式二</strong>：通过助手函数<code>model</code>（就不需要引入类的所在空间）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$catModel = model(<span class="string">'Category'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="media2/image4.png" alt=""></p>
<p>打印结果：</p>
<p><img src="media2/image5.png" alt=""></p>
<hr>
<h1 id="二、模型CURD操作"><a href="#二、模型CURD操作" class="headerlink" title="二、模型CURD操作"></a>二、模型CURD操作</h1><p><strong>C-create</strong>： 新增数据</p>
<p><strong>U-update</strong>： 更新数据</p>
<p><strong>R-read</strong>： 查询数据</p>
<p><strong>D-delete</strong>： 删除数据</p>
<h2 id="1、新增数据-C"><a href="#1、新增数据-C" class="headerlink" title="1、新增数据-C"></a>1、新增数据-C</h2><p>手册位置：模型->新增</p>
<h3 id="（1）添加一条数据"><a href="#（1）添加一条数据" class="headerlink" title="（1）添加一条数据"></a>（1）添加一条数据</h3><ul>
<li><p><strong>方式一</strong>【==推荐==】：通过<code>save</code>方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;save($data);</span><br></pre></td></tr></table></figure>
<p><strong>参数</strong>：$data为一维数组，其中[‘表字段名’=&gt;’数据’]</p>
<p><strong>返回值</strong>：成功返回写入的记录数</p>
</li>
</ul>
<pre><code>入库成功后，可以通过字段名当做模型对象属性获取对应的值，如获取自增主键字段值：

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;save($data);  </span><br><span class="line"><span class="keyword">echo</span> $model-&gt;cat_id;</span><br></pre></td></tr></table></figure>
</code></pre><ul>
<li><p><strong>方式二</strong>：通过<code>create</code>方法</p>
<p>使用模型名静态调用<code>create($data)</code>，如模型名为<code>User</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User::create($data);</span><br></pre></td></tr></table></figure>
<p><strong>参数</strong>：\$data为一维数组，其中[‘表字段名’=>‘数据’]</p>
<p><strong>返回值</strong>：和save方法不同的是，create方法返回的是当前模型的对象实例</p>
</li>
</ul>
<p>save方式：</p>
<p><img src="media2/image6.png" alt=""></p>
<p>create方式：</p>
<p><img src="media2/image7.png" alt=""></p>
<h3 id="（2）添加多条数据"><a href="#（2）添加多条数据" class="headerlink" title="（2）添加多条数据"></a>（2）添加多条数据</h3><p>   模型调用<code>saveAll</code>方法</p>
   <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;saveAll($data);</span><br></pre></td></tr></table></figure>
<p>   <strong>参数</strong> ：  \$data为二维数组，见下图。</p>
<p>   <strong>返回值</strong> ： 成功返回对象集合。<code>[obj,obj,obj,....]</code></p>
<p>   <img src="media2/image8.png" alt=""></p>
<h3 id="（3）过滤非数据表字段"><a href="#（3）过滤非数据表字段" class="headerlink" title="（3）过滤非数据表字段"></a>（3）过滤非数据表字段</h3><p>注意：<code>allowField</code>需要实例化模型，不能直接类调用</p>
<ul>
<li><p>只允许数据表中的字段写入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;allowField(<span class="keyword">true</span>)-&gt;save($data) ;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>只允许name和email字段写入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;allowField([<span class="string">'name'</span>,<span class="string">'email'</span>])-&gt;save($data);</span><br></pre></td></tr></table></figure>
<p><img src="media2/image9.png" alt=""></p>
</li>
</ul>
<h3 id="（4）-补充-数据库操作AR模式"><a href="#（4）-补充-数据库操作AR模式" class="headerlink" title="（4）(补充)数据库操作AR模式"></a>（4）(补充)数据库操作AR模式</h3><p><strong>AR</strong> ：Active Record 活跃的对象</p>
<ul>
<li><p>模型类映射成表</p>
</li>
<li><p>对象映射表中的一条记录</p>
</li>
<li><p>属性映射到记录中某个字段</p>
</li>
</ul>
<pre><code>![](media2/image10.png)

**所以，入库成功之后如果是返回一个当前记录的数据对象，可以通过`$model-&gt;字段名`去获取对应的字段值**
</code></pre><h2 id="2、更新数据-U"><a href="#2、更新数据-U" class="headerlink" title="2、更新数据-U"></a><strong>2、更新数据-U</strong></h2><p>手册位置：模型-->更新</p>
<h3 id="（1）更新方式一"><a href="#（1）更新方式一" class="headerlink" title="（1）更新方式一"></a>（1）更新方式一</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;save($data,更新条件);</span><br></pre></td></tr></table></figure>
<p>==注==：之前save方法只传入第一个参数为新增，通过<strong>第二个参数</strong>指定更新条件则为更新。</p>
<p>或者通过<code>isUpdate(true)</code>方法明确指定<code>save</code>为<strong>更新</strong>操作，其中<code>$data</code>中==必须==带更新的<strong>主键值</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;isUpdate(<span class="keyword">true</span>)-&gt;save($data);</span><br></pre></td></tr></table></figure>
<p>更新若需要过滤非数据表的字段数据，使用<code>allowField(true)</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;isUpdate(<span class="keyword">true</span>)-&gt;allowField(<span class="keyword">true</span>)-&gt;save($data);</span><br></pre></td></tr></table></figure>
<p><img src="media2/image11.png" alt=""></p>
<h3 id="（2）更新方式二-推荐"><a href="#（2）更新方式二-推荐" class="headerlink" title="（2）更新方式二(推荐)"></a>（2）更新方式二(推荐)</h3><p>   通过<code>update</code>方法实现，但这样就无法使用模型的<strong>事件功能</strong>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;update($data);</span><br></pre></td></tr></table></figure>
<p>   <strong>参数</strong> ：\$data为一维数组，键名为表字段名，其中更新必须指定==更新条件==，否则更新失败。</p>
<p>   <strong>返回值</strong> : 成功返回当前数据对象。</p>
<p><img src="media2/image12.png" alt=""></p>
<p>==注：==</p>
<ul>
<li><p><code>save</code>只能是<strong>模型</strong>对象调用</p>
</li>
<li><p><code>update</code>方法可以是<strong>模型</strong>对象或模型<strong>类名</strong>进行调用</p>
</li>
</ul>
<h2 id="3、删除数据-D"><a href="#3、删除数据-D" class="headerlink" title="3、删除数据-D"></a>3、删除数据-D</h2><h3 id="（1）删除方式一-推荐"><a href="#（1）删除方式一-推荐" class="headerlink" title="（1）删除方式一(推荐)"></a>（1）删除方式一(推荐)</h3><p>通过模型名静态方法<code>destroy</code>方法实现删除一条或多条数据</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Category::destroy(<span class="number">1</span>);  <span class="comment">// 删除主键为1的记录</span></span><br><span class="line">Category::destroy(<span class="string">'1,2,3'</span>);  <span class="comment">//删除主键为1,2,3的记录</span></span><br><span class="line"><span class="comment"># 或数组形式</span></span><br><span class="line">Category::destroy([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);</span><br></pre></td></tr></table></figure>
<p><strong>参数</strong>：主键值</p>
<p><strong>返回值</strong>：返回受影响的行数</p>
<p><img src="media2/image13.png" alt=""></p>
<h3 id="（2）删除方式二AR模式"><a href="#（2）删除方式二AR模式" class="headerlink" title="（2）删除方式二AR模式"></a>（2）删除方式二AR模式</h3><p>先获取当前数据的模型对象，在调用delete方法进行删除</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$category = Category::get(<span class="number">1</span>);  <span class="comment">// 获取主键为1的记录</span></span><br><span class="line">$category-&gt;delete();  <span class="comment">//执行删除</span></span><br></pre></td></tr></table></figure>
<p><strong>返回值</strong>：delete删除成功返回受影响的行数。</p>
<p><img src="media2/image14.png" alt=""></p>
<p><strong>一般数据是不会删除的，通过逻辑删除。</strong></p>
<p><strong>逻辑删除</strong> ：即通过表中的某个字段如<code>is_delete</code>进行维护 ,值为1就是删除，值为0就是未删除。</p>
<p><strong>物理删除</strong>：直接删除这一条记录。</p>
<h2 id="4、查询数据-R"><a href="#4、查询数据-R" class="headerlink" title="4、查询数据-R"></a>4、查询数据-R</h2><h3 id="（1）获取一条记录"><a href="#（1）获取一条记录" class="headerlink" title="（1）获取一条记录"></a>（1）获取一条记录</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Category::get(<span class="number">1</span>);	<span class="comment">// 获取主键值为1的记录</span></span><br><span class="line">Category::find(<span class="number">1</span>);  <span class="comment">// 或获取主键值为1的记录， 推荐</span></span><br></pre></td></tr></table></figure>
<p><strong>参数</strong>：主键值</p>
<p><strong>返回值</strong>：成功返回当前记录数据对象</p>
<p><img src="media2/image15.png" alt=""></p>
<p><strong>get和find的区别：</strong></p>
<ul>
<li><p><code>find()</code> ：可以是对象或类名调用，前面支持连贯操作（<code>where()</code>、<code>field()</code>、<code>order</code>等）。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model-&gt;where(<span class="string">'id = 1'</span>)-&gt;find()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>get()</code>： 也可以是对象或类名调用，前面==不==支持连贯操作，但可以传递一个闭包函数实现连贯操作。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Category::get(<span class="function"><span class="keyword">function</span><span class="params">($query)</span></span>&#123;</span><br><span class="line">	$query-&gt;where(<span class="string">'id = 1'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="media2/image16.png" alt=""></p>
<h3 id="（3）获取多条记录"><a href="#（3）获取多条记录" class="headerlink" title="（3）获取多条记录"></a>（3）获取多条记录</h3><p>通过<code>select</code>或<code>all</code>方法，==推荐<code>select</code>==</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Category::all();  <span class="comment">// 获取表所有数据</span></span><br><span class="line">Category::all(<span class="string">'1,2,3'</span>); <span class="comment">//获取主键值为1,2,3的记录</span></span><br><span class="line"><span class="comment"># 或数组形式</span></span><br><span class="line">Category::all([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]); <span class="comment">//获取主键值为1,2,3的记录</span></span><br><span class="line"></span><br><span class="line">Category::select();  <span class="comment">//获取表中的所有数据</span></span><br><span class="line">Category::select(<span class="string">'1,2,3'</span>);  <span class="comment">//获取主键值为1,2,3的记录</span></span><br></pre></td></tr></table></figure>
<p><strong>返回值</strong>：<code>all</code>和<code>select</code>都是返回对象集合。[obj,obj]</p>
<p><img src="media2/image17.png" alt=""></p>
<p><strong><code>all</code>和<code>select</code>的区别：</strong></p>
<ul>
<li><p><code>select()</code> ：可以是类名和对象调用，前面支持连贯操作。</p>
</li>
<li><p><code>all()</code> ：可以是类名和对象调用，前面不支持连贯操作，但可以通过闭包函数实现。</p>
</li>
</ul>
<p>需要把数据对象转化为关联数组，可以调用<code>toArray()</code>进行转换，打印数据更加直观</p>
<p><img src="media2/image18.png" alt=""></p>
<h3 id="（4）设置数据返回类型"><a href="#（4）设置数据返回类型" class="headerlink" title="（4）设置数据返回类型"></a>（4）设置数据返回类型</h3><p>模型默认查询数据方法<code>get</code>和<code>find</code>都是返回当前的数据对象object，可以调用<code>toArray</code>转化为关联数组。</p>
<p>all和select方法都是返回对象集合。如：[object，object，object,...]，他们是不可以调用调用toArray方法的，但可以修改<code>application/database.php</code>文件配置项，可以指定返回数据类型为集合方可调用<code>toArray</code>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据返回类型</span></span><br><span class="line"><span class="string">'resultset_type'</span>  =&gt; <span class="string">'think\Collection'</span>,</span><br></pre></td></tr></table></figure>
<p>之后<code>all</code>和<code>selec()-&gt;toArray()</code>返回的就是二维关联数组</p>
<h2 id="5、连贯操作"><a href="#5、连贯操作" class="headerlink" title="5、连贯操作"></a>5、连贯操作</h2><p>手册位置：数据库-->查询构造器-->链式操作</p>
<p><strong>注： 模型的链式操作方法和Db构造器链式操作的方法都通用；</strong></p>
<p><strong>TP5常用的模型或Db构造器连贯操作方法如下：</strong></p>
<ul>
<li><p><code>field(&quot;field1,field2...&quot;)</code>：查询指定的字段field1和field2，多个用逗号隔开。</p>
</li>
<li><p><code>alias(&#39;数据表别名&#39;)</code>：给当前模型设置别名，一般在<strong>join</strong>联表时使用较多。</p>
</li>
<li><p><code>where(查询条件)</code>：其中查询条件可以为表达式查询、数组查询、字符串查询。</p>
</li>
<li><p><code>order(&quot;field desc&quot;)</code>：把查询的到结果集根据字段field降序（desc）或升序(asc)。</p>
</li>
<li><p><code>group(&quot;field&quot;)</code> ： 把查询的结果集根据字段field分组。</p>
</li>
<li><p><code>limit(offset,length)</code> ： 获取结果集指定条数的数据， offset为起始位置，length为获取记录的条数。</p>
</li>
<li><p><code>join()</code>：与其他表进行关联查询</p>
</li>
</ul>
<pre><code>注意：

以上的连贯操作方法都是**返回当前模型的对象**，即方法底层都是返回当前模型对象(`return $this`)，所以他们之间的调用顺序不用按照原生的sql顺序来调用，但如果是查询数据，查询语句的最末端一定要确保是select或者是find方法。

在原生的sql语句中一定要按照先后顺序调用：

顺序为:join==\&gt;where ==\&gt; group ==\&gt; having\=\=\&gt;order==\&gt;limit

但在tp5中以上的连贯操作都不需要按照顺序。
</code></pre><h3 id="（1）where条件查询"><a href="#（1）where条件查询" class="headerlink" title="（1）where条件查询"></a>（1）where条件查询</h3><ul>
<li><p><strong>where表达式查询条件</strong></p>
<p><img src="media2/image19.png" alt=""></p>
<p><img src="media2/image20.png" alt=""></p>
</li>
<li><p><strong>where数组查询条件(推荐)</strong></p>
<p>完整语法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$where = [</span><br><span class="line">    <span class="string">'字段名1'</span>=&gt; [表达式，<span class="string">'值'</span>]</span><br><span class="line">    <span class="string">'字段名2'</span>=&gt; [表达式，<span class="string">'值'</span>]</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 如果是等值（=）查询，可以不用指定表达式，直接写值即可,如下</span></span><br><span class="line">$where = [</span><br><span class="line">		<span class="string">'字段名'</span> =&gt;<span class="string">'值'</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>![](media2/image21.png)
</code></pre><ul>
<li><p><strong>where字符串查询条件</strong></p>
<p>语法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where(<span class="string">'字符串条件'</span>)</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<p><img src="media2/image22.png" alt=""></p>
<p>注：</p>
<ul>
<li><p>默认多字段查询是<strong>and</strong>连接。如果想使用<strong>or</strong>连接,可以使用方法<code>whereOr()</code>  ；</p>
</li>
<li><p>当排查sql语句是否有错误时，可以在连贯方法后面调用 <code>buildSql()</code>获得组装的sql语句，再把sql语句复制进行如navicat工具中进行执行，获取详细的错误信息。</p>
<p><img src="media2/image23.png" alt=""></p>
<p>效果：</p>
<p><img src="media2/image24.png" alt=""></p>
</li>
</ul>
</li>
</ul>
<h3 id="（2）join联表"><a href="#（2）join联表" class="headerlink" title="（2）join联表"></a>（2）join联表</h3><p>手册位置：数据库-->查询构造器-->链式操作-->join</p>
<p>基本语法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object join ( mixed join [, mixed $condition = <span class="keyword">null</span> [, string $type = <span class="string">'INNER'</span>]] )</span><br></pre></td></tr></table></figure>
<p><strong>参数</strong>：</p>
<p><code>join</code>：要关联的（完整）表名以及别名</p>
<p> 支持三种写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">写法1：[ &apos;完整表名或者子查询&apos;=&gt;&apos;别名&apos; ]</span><br><span class="line">写法2：&apos;完整表名 别名&apos;</span><br><span class="line">写法3：&apos;不带数据表前缀的表名&apos;</span><br></pre></td></tr></table></figure></p>
<p><code>$condition</code>：关联条件。可以为字符串或数组， 为数组时每一个元素都是一个关联条件。</p>
<p><code>$type</code>：关联类型。可以为: <code>INNER</code>、<code>LEFT</code>、<code>RIGHT</code>、<code>FULL</code>，==不区分大小写==，默认为<code>INNER</code>。</p>
<p>如：查询出文章所属分类名称：</p>
<p>sql原生写法：</p>
<p><img src="media2/image26.png" alt=""></p>
<p>使用模型的join实现上面的功能：</p>
<p><img src="media2/image27.png" alt=""></p>
<p>效果：</p>
<p><img src="media2/image28.png" alt=""></p>
<h2 id="6、聚合（统计）函数"><a href="#6、聚合（统计）函数" class="headerlink" title="6、聚合（统计）函数"></a>6、聚合（统计）函数</h2><p>常用的有以下几个聚合（统计）函数</p>
<p><img src="media2/image29.png" alt=""></p>
<p>注意:调用统计函数前均支持连贯方法，但必须保证最末端是统计函数。</p>
<p><img src="media2/image30.png" alt=""></p>
<h2 id="7、模型完成时间戳的自动维护"><a href="#7、模型完成时间戳的自动维护" class="headerlink" title="7、模型完成时间戳的自动维护"></a>7、模型完成时间戳的自动维护</h2><p>手册位置：模型-->时间戳</p>
<p><strong>步骤1</strong>：首先给表设置 <code>update_time</code>、<code>create_time</code>字段，类型为<strong>int</strong>。</p>
<p><img src="media2/image31.png" alt=""></p>
<p><strong>步骤2：</strong> 在当前表模型中开启时间戳的自动写入，在子类(<code>Category</code>)中设置覆盖父类。</p>
<p><img src="media2/image32.png" alt=""></p>
<p>开启时间戳自动写入之后，后面只要使用模型完成新增或编辑的操作，就会对表的两个时间字段字段进行自动维护。</p>
<hr>
<h1 id="三、通过Db构造器操作数据库"><a href="#三、通过Db构造器操作数据库" class="headerlink" title="三、通过Db构造器操作数据库"></a>三、通过Db构造器操作数据库</h1><p>通Db构造器操作数据库无需实例化模型也可对数据进行CURD操作。但有些功能会没有，如模型的时间戳自动维护等。</p>
<p>手册位置：数据库-->查询构造器</p>
<h2 id="1、查询数据-R"><a href="#1、查询数据-R" class="headerlink" title="1、查询数据-R"></a>1、查询数据-R</h2><ul>
<li><p>需先引入Db类</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Db</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>查询一条数据，返回一维关联数组</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;field(<span class="string">'username,email'</span>)-&gt;where(id,<span class="number">1</span>)-&gt;find(); </span><br><span class="line"><span class="comment">// table('表名')</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>查询多条数据，返回二维关联数组</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(id,<span class="number">1</span>)-&gt;select(); </span><br><span class="line">Db::name(<span class="string">'user'</span>)-&gt;order(<span class="string">'id desc'</span>)-&gt;select(); <span class="comment">#不带表前缀</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>通过助手函数<code>db(表名)</code>获取Db对象，其表名不含表前缀</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db(<span class="string">'category'</span>)-&gt;where(id,<span class="number">1</span>)-&gt;find();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>==注:==

`Db::table(&apos;t_category&apos;)`：需要完整表名，带表前缀。

`DB::name(&apos;category&apos;)`：是不带表前缀，且他们都支持连贯操作，只需保证最末端是select或是find或统计函数。

模型和Db构造器的连贯方法都是**通用**的。
</code></pre><p><img src="media2/image33.png" alt=""></p>
<h2 id="2、添加数据-C"><a href="#2、添加数据-C" class="headerlink" title="2、添加数据-C"></a>2、添加数据-C</h2><ul>
<li><p><strong>添加一条数据</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'tp_category'</span>)-&gt;insert($data);</span><br></pre></td></tr></table></figure>
<p><strong>参数</strong>：\$data为一维数组，键名必须为表的字段名。</p>
<p><strong>返回值</strong>：成功返回1</p>
</li>
</ul>
<ul>
<li><p>或者直接使用<code>insertGetId</code>方法新增数据并返回新增记录的主键值</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::name(<span class="string">'category'</span>)-&gt;insertGetId($data);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>添加多条数据</strong></p>
<p>添加多条数据直接向 Db 类的<code>insertAll</code>方法传入需要添加的数据即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$data = [</span><br><span class="line">    [<span class="string">'foo'</span> =&gt; <span class="string">'bar'</span>, <span class="string">'bar'</span> =&gt; <span class="string">'foo'</span>],</span><br><span class="line">    [<span class="string">'foo'</span> =&gt; <span class="string">'bar1'</span>, <span class="string">'bar'</span> =&gt; <span class="string">'foo1'</span>],</span><br><span class="line">    [<span class="string">'foo'</span> =&gt; <span class="string">'bar2'</span>, <span class="string">'bar'</span> =&gt; <span class="string">'foo2'</span>]</span><br><span class="line">];</span><br><span class="line">Db::name(<span class="string">'user'</span>)-&gt;insertAll($data);</span><br></pre></td></tr></table></figure>
<p>返回值：成功返回添加记录的条数。</p>
</li>
</ul>
<p><img src="media2/image35.png" alt=""></p>
<h2 id="3、删除数据-D-1"><a href="#3、删除数据-D-1" class="headerlink" title="3、删除数据-D"></a>3、删除数据-D</h2><ul>
<li><p><strong>根据主键删除</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;delete(<span class="number">1</span>);</span><br><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;delete([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>条件删除</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>,<span class="number">1</span>)-&gt;delete();</span><br><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>,<span class="string">'&lt;'</span>,<span class="number">10</span>)-&gt;delete();</span><br></pre></td></tr></table></figure>
<p><code>delete</code>方法返回影响数据的条数，没有删除返回 0</p>
</li>
</ul>
<h2 id="4、更新数据-U"><a href="#4、更新数据-U" class="headerlink" title="4、更新数据-U"></a>4、更新数据-U</h2><p>手册位置：数据库-->查询构造器-->更新数据</p>
<h3 id="（1）更新数据表中的数据"><a href="#（1）更新数据表中的数据" class="headerlink" title="（1）更新数据表中的数据"></a>（1）更新数据表中的数据</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;update([<span class="string">'name'</span> =&gt; <span class="string">'thinkphp'</span>]);</span><br></pre></td></tr></table></figure>
<p><strong>返回值</strong> ：成功返回受影响的行数，没做任何修改返回 0</p>
<p><img src="media2/image36.png" alt=""></p>
<p>若更新数据中包含主键id，可以省略where方法，可以直接使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 包含主键id  : 'id'=&gt;1</span></span><br><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;update([<span class="string">'name'</span> =&gt; <span class="string">'thinkphp'</span>,<span class="string">'id'</span>=&gt;<span class="number">1</span>]);</span><br></pre></td></tr></table></figure>
<p><img src="media2/image37.png" alt=""></p>
<h3 id="（2）更新某个字段的值"><a href="#（2）更新某个字段的值" class="headerlink" title="（2）更新某个字段的值"></a>（2）更新某个字段的值</h3><p>把id=1的记录name字段改为thinkphp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>,<span class="number">1</span>)-&gt;setField(<span class="string">'name'</span>, <span class="string">'thinkphp'</span>);</span><br></pre></td></tr></table></figure>
<p><strong>返回值</strong>：成功返回受影响记录的行数，没做任何修改返回 0</p>
<p><img src="media2/image38.png" alt=""></p>
<h3 id="（3）自增或自减一个字段的值"><a href="#（3）自增或自减一个字段的值" class="headerlink" title="（3）自增或自减一个字段的值"></a>（3）自增或自减一个字段的值</h3><p><strong>自增</strong> </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setInc(<span class="string">'字段名'</span>，步长);</span><br></pre></td></tr></table></figure>
<p><strong>自减</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setDec(<span class="string">'字段名'</span>，步长);</span><br></pre></td></tr></table></figure>
<p><strong>注意：若不指定第二个参数，默认自增或自减数为1</strong></p>
<p><strong>示例</strong></p>
<p>score 字段加 1</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;setInc(<span class="string">'score'</span>);</span><br></pre></td></tr></table></figure>
<p>score 字段加 5</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;setInc(<span class="string">'score'</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>score 字段减 1</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;setDec(<span class="string">'score'</span>);</span><br></pre></td></tr></table></figure>
<p>score 字段减 5</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table(<span class="string">'think_user'</span>)-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;setDec(<span class="string">'score'</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<h2 id="5、执行原生sql语句"><a href="#5、执行原生sql语句" class="headerlink" title="5、执行原生sql语句"></a>5、执行原生sql语句</h2><p><strong>查询</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::query(<span class="string">'select... '</span>);</span><br></pre></td></tr></table></figure>
<p><strong>返回值</strong>：成功返回二维关联数组</p>
<p><strong>增删改</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::execute(<span class="string">'insert/update/delete'</span>);</span><br></pre></td></tr></table></figure>
<p><strong>返回值</strong>：成功返回受影响的行数</p>
<p><img src="media2/image34.png" alt=""></p>
<hr>
<h1 id="TP5第三天"><a href="#TP5第三天" class="headerlink" title="==TP5第三天=="></a>==TP5第三天==</h1><h1 id="一、composer概述"><a href="#一、composer概述" class="headerlink" title="一、composer概述"></a>一、composer概述</h1><h2 id="1、什么是composer"><a href="#1、什么是composer" class="headerlink" title="1、什么是composer"></a>1、什么是composer</h2><p>Composer 是 PHP 的一个包==依赖管理工具== ， 不是一个包管理器。 能够帮助我们安装我们项目所需要的依赖包。</p>
<p>假设有个文件A.php,我们项目中使用需要就include A.php 包含进来，但是A.php又基于B.php,所以我们在A.php文件中又需要include B,但是不幸的B.php又基于C.php和D.php,于是又要在B.php进行include C.php和D.php 。假设C和D文件又基于其他文件，那么这样互相依赖的关系可能无止境。</p>
<p><img src="media3/image1.png" alt=""></p>
<p>那么在项目中使用<strong>composer</strong>就可以解决各个文件互相依赖的问题。</p>
<p>除了解决文件依赖的关系，它还有更多的<strong>优点</strong>：</p>
<ul>
<li>下载网络上别人分享的优秀的类库（包）。</li>
<li>可对下载的类库进行管理，如：删除、更新等众多便利的操作。</li>
</ul>
<p>其实composer也就类似与Linux中yum，前端中的npm、bower等操作。这些工具都是可以用来管理我们项目的依赖文件。</p>
<h2 id="2、安装composer"><a href="#2、安装composer" class="headerlink" title="2、安装composer"></a>2、安装composer</h2><p><strong>安装方式一般有两种方式：</strong></p>
<ul>
<li><p>第一种方式：</p>
<p>去composer官网( <a href="https://getcomposer.org/download/" target="_blank" rel="noopener">https://getcomposer.org/download/</a> )下载<code>Composer-setup.exe</code>进行在线安装，由于此软件安装需要联网且服务器在国外安装很难成功，所以这里推荐使用下面第二种方式进行安装。</p>
<p><img src="media3/image2.png" alt=""></p>
</li>
<li><p>[<strong>==推荐==</strong>]第二种方式</p>
<p>去官网<a href="https://getcomposer.org/download" target="_blank" rel="noopener">https://getcomposer.org/download</a> 下载<code>composer.phar</code>文件。</p>
<p><img src="media3/image3.png" alt=""></p>
<p>找到并进入 PHP 的安装目录,将下载的<code>composer.phar</code> 复制到 ==PHP 的安装目录==下面，也就是和 php.exe 在同一级目录。</p>
<p><img src="media3/image4.png" alt=""></p>
<p>在 PHP 安装目录（<code>D:\phpStudy\php\php-5.6.27-nts</code>）下新建一个<code>composer.bat</code>文件，并将下列代码保存到此文件中。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@php "%~dp0composer.phar" %*</span><br></pre></td></tr></table></figure>
<p>至此composer的安装就完成。</p>
<p>进入对应php版本目录(<code>D:\phpStudy\php\php-5.6.27-nts</code>)中输入<code>composer</code>指令，出现如下提示代表安装成功：</p>
<p><img src="media3/image5.png" alt=""></p>
</li>
</ul>
<pre><code>为了可以全局（任意位置）访问composer，可以把php.exe的所在目录（`D:\phpStudy\php\php-5.6.27-nts`）定义在环境变量path选项中。

![](media3/image6.png)

设置好后输入`php -v`即可看到php版本号。

![](media3/image7.png)

cmd中任意位置输入`composer`指令：

![](media3/image8.png)
</code></pre><h2 id="3、为composer配置国内镜像"><a href="#3、为composer配置国内镜像" class="headerlink" title="3、为composer配置国内镜像"></a>3、为composer配置国内镜像</h2><p>由于composer需要去网址为<a href="https://packagist.org" target="_blank" rel="noopener">https://packagist.org</a> 获取代码库地址，再通过地址去github上去下载代码到我们项目本地，由于这两个地址服务器都在国外，访问比较慢，也不稳定。</p>
<p><img src="media3/image9.png" alt=""></p>
<p>配置国内镜像：<a href="https://pkg.phpcomposer.com/" target="_blank" rel="noopener">https://pkg.phpcomposer.com/</a></p>
<p>输入命令</p>
<p><strong>全局配置</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer config -g repo.packagist composer https://packagist.phpcomposer.com</span><br></pre></td></tr></table></figure>
<p><img src="media3/image10.png" alt=""></p>
<p>如上，参看composer配置命令，可查看composer配置保存的路径，全局的默认在当前用户文件夹下。</p>
<p><strong>局部配置</strong>：若只想在当前项目中有效，把上面的命令去掉 -g 即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer config  repo.packagist composer https://packagist.phpcomposer.com</span><br></pre></td></tr></table></figure>
<h2 id="4、composer相关命令"><a href="#4、composer相关命令" class="headerlink" title="4、composer相关命令"></a>4、composer相关命令</h2><p><strong>包地址</strong>：<a href="https://packagist.org/" target="_blank" rel="noopener">https://packagist.org/</a></p>
<p><strong>参考阅读</strong></p>
<p><a href="https://docs.phpcomposer.com/01-basic-usage.html" target="_blank" rel="noopener">Composer 基本使用</a></p>
<p><a href="https://segmentfault.com/a/1190000005898222" target="_blank" rel="noopener">Composer进阶使用 —— 常用命令和版本约束</a></p>
<ul>
<li><p><strong>查看所有的composer可以使用的命令</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer list</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>查看某个命令的使用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require --help</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>composer创建项目</strong></p>
<p>该命令是用来安装项目的，可以通过该命令去下载对应的项目文件。如，下载thinkphp框架</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; composer create-project   团队名称/包名称[=版本号] [指定下载目录]  [-vvv打印交互信息]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project topthink/think  shop</span><br></pre></td></tr></table></figure>
<p>注：其中<code>shop</code>代表框架存放的目录，会自动生成，未指定则默认放在同名(<code>think</code>)目录</p>
</li>
</ul>
<ul>
<li><p><strong>安装一些第三方包</strong> </p>
<p>该命令是用来安装项目开发中的依赖文件，例如上传类库、验证码类库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require 厂商/包名=版本号</span><br></pre></td></tr></table></figure>
<p>注：若不指定版本号默认安装最新版本</p>
<p>如安装tp5验证码1.0.3 版本：<code>composer require topthink/think-captcha=1.0.3</code></p>
<p>如安装tp5验证码1.0的最高版本：<code>composer require topthink/think-captcha=1.0.*</code></p>
</li>
</ul>
<pre><code>**包名所有的版本**：https://packagist.org/packages/topthink/think-captcha
</code></pre><ul>
<li><p><strong>安装<code>composer.json</code>指定的依赖包</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer install</span><br></pre></td></tr></table></figure>
<p>会自动安装在composer.json文件中所指定的各种依赖包，执行成功后会<strong>多处</strong>生成一个composer.lock的锁文件。后面需要更新依赖库只能通过<code>composer update</code>实现安装。</p>
<p><code>composer.json</code>文件说明：<br><a href="https://docs.phpcomposer.com/01-basic-usage.html#composer.json-Project-Setup" target="_blank" rel="noopener">https://docs.phpcomposer.com/01-basic-usage.html#composer.json-Project-Setup</a></p>
<p><code>composer.json</code>文件架构详解：<a href="https://docs.phpcomposer.com/04-schema.html" target="_blank" rel="noopener">https://docs.phpcomposer.com/04-schema.html</a></p>
</li>
</ul>
<ul>
<li><p><strong>删除指定的包</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer remove topthink/think-captcha</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>搜索指定的包</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer search topthink/think-captcha</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>更新依赖包</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer update</span><br></pre></td></tr></table></figure>
<p>若修改<code>composer.json</code>中<strong>require</strong>指定的依赖包，则存在<code>composer.lock</code>文件，则只能通过</p>
<p><code>composer update</code>进行更新。</p>
</li>
</ul>
<ul>
<li><p><strong>取消镜像</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer config -g --unset repos.packagist</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>查看当前composer版本</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer -v</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><strong>升级composer版本</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer selfupdate</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h1 id="二、使用composer安装tp5验证码"><a href="#二、使用composer安装tp5验证码" class="headerlink" title="二、使用composer安装tp5验证码"></a>二、使用composer安装tp5验证码</h1><p>手册位置：杂项-->验证码</p>
<p><strong>步骤1</strong>：切换到项目根目录即<code>composer.json</code>所在的目录，输入指令 <code>composer require topthink/think-captcha=1.0.*</code>进行安装。 在指定目录打开cmd，快捷键：ctrl+shfit+鼠标右键</p>
<p><img src="media3/image11.png" alt=""></p>
<p><strong>注：不要安装2.0以上版本，此版本需要tp5是5.1版本，我们tp5版本是5.0版本</strong> </p>
<p>默认下载的tp5框架已经帮我们下载好了验证码，不用composer安装可直接使用即可。</p>
<p><img src="media3/image12.png" alt=""></p>
<hr>
<h1 id="TP5第四天"><a href="#TP5第四天" class="headerlink" title="==TP5第四天=="></a>==TP5第四天==</h1><h1 id="一、XSS攻击"><a href="#一、XSS攻击" class="headerlink" title="一、XSS攻击"></a>一、XSS攻击</h1><h2 id="1、xss介绍"><a href="#1、xss介绍" class="headerlink" title="1、xss介绍"></a>1、xss介绍</h2><p><img src="media4/image31.png" alt=""></p>
<p><strong>演示</strong></p>
<p>如在输入框输入js代码：</p>
<p><img src="media4/image32.png" alt=""></p>
<p>页面访问此标题的时候就会弹出1，从而达成攻击；</p>
<p><img src="media4/image33.png" alt=""></p>
<h2 id="2、防止xss攻击（防止js攻击）"><a href="#2、防止xss攻击（防止js攻击）" class="headerlink" title="2、防止xss攻击（防止js攻击）"></a>2、防止xss攻击（防止js攻击）</h2><h3 id="2-1、使用htmlspecialchars函数防止"><a href="#2-1、使用htmlspecialchars函数防止" class="headerlink" title="2.1、使用htmlspecialchars函数防止"></a>2.1、使用htmlspecialchars函数防止</h3><p><strong>htmlspecialchars</strong>函数的作用：将html标签符号转化为实体符号。</p>
<p>如：大于号”>“会被转化为 <code>&amp;gt;</code></p>
<p>如：小于号”\&lt;”会被转化为 <code>&amp;lt;</code></p>
<p>tp5框架的<strong>input</strong>函数第三个参数可以指定过滤函数，若想要==全局过滤==可以在配置文件<code>application/config.php</code>中添加全局的过滤函数：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认全局过滤方法 用逗号分隔多个</span></span><br><span class="line"><span class="string">'default_filter'</span>         =&gt; <span class="string">'htmlspecialchars'</span>,</span><br></pre></td></tr></table></figure>
<p><strong>注</strong>：百度富文本编辑器，默认会进行过滤js代码。</p>
<p>设置好全局过滤函数之后，通过富文本编辑器添加的文章内容显示如下：</p>
<p><img src="media4/image34.png" alt=""></p>
<p>可见，全局设置的==缺点==会把html和js代码的特殊符号都进行转义。我们只希望转义危险的js代码，虽然解决了xss攻击，但富文本编辑器设置的html代码没有正常显示，这是我们不希望看到的。但可以借助<code>htmlspecialchars_decode()</code>进行反转，把html实体符号转化为html标签，但这又可能会造成xss攻击。</p>
<p>可见：</p>
<ol>
<li><p>不使用函数<code>htmlspecialchars()</code>进行处理，可能会出现xss攻击。</p>
</li>
<li><p>使用<code>htmlspecialchars()</code>函数进行过滤，但页面的数据（富文本编辑器设置的内容）又不能正常显示出来，可以借助<code>htmlspecialchars_decode()</code>进行反转，把html实体符号转化为html标签，但这又可能会造成xss攻击。</p>
</li>
</ol>
<p>我们的希望是html标签可以正常显示，但是又不希望js代码被执行。</p>
<p><strong>解决xss攻击办法：</strong></p>
<p>这时可以借助第三方防止xss攻击的插件如：<strong>==HTMLPurifier==</strong>，此插件会把浏览器提交过来的数据有选择性的过滤。只过滤危险的js代码，保留html代码，这就刚好满足我们的需求。</p>
<h3 id="2-2、使用插件HTMLPurifier防止XSS攻击"><a href="#2-2、使用插件HTMLPurifier防止XSS攻击" class="headerlink" title="2.2、使用插件HTMLPurifier防止XSS攻击"></a>2.2、使用插件HTMLPurifier防止XSS攻击</h3><p><strong>步骤1</strong>：复制防止xss攻击的文件到extends目录中去</p>
<p><img src="media4/image35.png" alt=""></p>
<p><strong>步骤2</strong>：把HTMLPurifier目录中的<code>example.php</code>中的<code>removeXSS</code> 函数复制到<code>common.php</code>文件中</p>
<p><img src="media4/image36.png" alt=""></p>
<p>修改应用配置<code>config.php</code>文件的全局过滤函数为上面的函数</p>
<p><img src="media4/image37.png" alt=""></p>
<p>测试如下：</p>
<p><img src="media4/image38.png" alt=""></p>
<p>可见，html代码可以正常显示，js代码被过滤了。</p>
<hr>

      
    </div>

    

    
    
    

    

    
       
    
    

    
      <div>
        



  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Kuma</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="http://blog.kuma8866.top/posts/1124976518/" title="TP5框架">http://blog.kuma8866.top/posts/1124976518/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/posts/1102202886/" rel="next" title="Index">
                <i class="fa fa-chevron-left"></i> Index
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/posts/2661724692/" rel="prev" title="博客项目4">
                博客项目4 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Kuma">
            
              <p class="site-author-name" itemprop="name">Kuma</p>
              <p class="site-description motion-element" itemprop="description">爱分享，爱技术，爱生活。</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">128</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">43</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/KumaNNN" title="GitHub &rarr; https://github.com/KumaNNN" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:kuma8866@163.com" title="E-Mail &rarr; mailto:kuma8866@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                <a href="/link/" target="_blank">友情链接</a>
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://example.com/" title="http://example.com/" rel="noopener" target="_blank">Title</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.baidu.com" title="http://www.baidu.com" rel="noopener" target="_blank">百度</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#TP5第一天"><span class="nav-text">==TP5第一天==</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一、框架概述"><span class="nav-text">一、框架概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、什么是框架"><span class="nav-text">1、什么是框架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、框架开发的好处"><span class="nav-text">2、框架开发的好处</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、框架的设计模式-MVC"><span class="nav-text">3、框架的设计模式(MVC)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、常见的php开发框架"><span class="nav-text">4、常见的php开发框架</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）ThinkPHP框架（TP框架）"><span class="nav-text">（1）ThinkPHP框架（TP框架）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）CodeIgniter-框架"><span class="nav-text">（2）CodeIgniter 框架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）YII-易框架"><span class="nav-text">（3）YII(易框架)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（4）Laravel框架"><span class="nav-text">（4）Laravel框架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（5）Zend官方框架"><span class="nav-text">（5）Zend官方框架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（6）Symfony国外框架"><span class="nav-text">（6）Symfony国外框架</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、ThinkPHP5框架"><span class="nav-text">二、ThinkPHP5框架</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、下载TP5框架"><span class="nav-text">1、下载TP5框架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、TP5框架的目录结构"><span class="nav-text">2、TP5框架的目录结构</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、使用TP5框架部署项目"><span class="nav-text">三、使用TP5框架部署项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、配置项目虚拟主机"><span class="nav-text">1、配置项目虚拟主机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、访问虚拟主机"><span class="nav-text">2、访问虚拟主机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、响应输出"><span class="nav-text">3、响应输出</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、控制器"><span class="nav-text">四、控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、控制器的作用"><span class="nav-text">1、控制器的作用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、创建控制器"><span class="nav-text">2、创建控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）修改控制器后缀"><span class="nav-text">（1）修改控制器后缀</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#important"><span class="nav-text">!important</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）创建控制器语法"><span class="nav-text">（2）创建控制器语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）隐藏入口文件进行访问（rewrite重写模式）"><span class="nav-text">（3）隐藏入口文件进行访问（rewrite重写模式）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（4）开启调试模式"><span class="nav-text">（4）开启调试模式</span></a></li></ol></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#五、项目分组-模块"><span class="nav-text">五、项目分组(模块)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、创建分组"><span class="nav-text">1、创建分组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、默认分组的设置"><span class="nav-text">2、默认分组的设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、分组的访问权限控制"><span class="nav-text">3、分组的访问权限控制</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六、命令行操作-了解"><span class="nav-text">六、命令行操作(了解)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、命令行创建分组"><span class="nav-text">1、命令行创建分组</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#important-1"><span class="nav-text">!important</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、命令行创建控制器"><span class="nav-text">2、命令行创建控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#important-2"><span class="nav-text">!important</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、命令行创建模型类"><span class="nav-text">3、命令行创建模型类</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七、路由（重要）"><span class="nav-text">七、路由（重要）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、路由模式"><span class="nav-text">1、路由模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）普通模式"><span class="nav-text">（1）普通模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）混合模式"><span class="nav-text">（2）混合模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）强制模式"><span class="nav-text">（3）强制模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、定义路由"><span class="nav-text">2、定义路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、定义路由分组"><span class="nav-text">3、定义路由分组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、定义路由参数-路由参数绑定"><span class="nav-text">4、定义路由参数(路由参数绑定)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）定义单个路由参数"><span class="nav-text">（1）定义单个路由参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）定义多个路由参数"><span class="nav-text">（2）定义多个路由参数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#八、输出视图-模版"><span class="nav-text">八、输出视图(模版)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#九、模板分配变量"><span class="nav-text">九、模板分配变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十、修改模版的定界符"><span class="nav-text">十、修改模版的定界符</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十一、模板常用标签"><span class="nav-text">十一、模板常用标签</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、volist和foreach"><span class="nav-text">1、volist和foreach</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、php标签"><span class="nav-text">2、php标签</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、include标签"><span class="nav-text">3、include标签</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十二、助手函数"><span class="nav-text">十二、助手函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、url"><span class="nav-text">1、url()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、config"><span class="nav-text">2、config()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、dump-和halt"><span class="nav-text">3、dump()和halt()</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十三、Request对象"><span class="nav-text">十三、Request对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、获取Request对象"><span class="nav-text">1、获取Request对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、获取请求信息"><span class="nav-text">2、获取请求信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、获取请求参数"><span class="nav-text">3、获取请求参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）获取GET和POST参数"><span class="nav-text">（1）获取GET和POST参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）参数默认值"><span class="nav-text">（2）参数默认值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）参数过滤"><span class="nav-text">（3）参数过滤</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TP5第二天"><span class="nav-text">==TP5第二天==</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一、数据库操作"><span class="nav-text">一、数据库操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、创建数据库数据"><span class="nav-text">1、创建数据库数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、配置数据库信息"><span class="nav-text">2、配置数据库信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、模型"><span class="nav-text">3、模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）模型作用"><span class="nav-text">（1）模型作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）模型的定义"><span class="nav-text">（2）模型的定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）实例化模型"><span class="nav-text">（3）实例化模型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、模型CURD操作"><span class="nav-text">二、模型CURD操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、新增数据-C"><span class="nav-text">1、新增数据-C</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）添加一条数据"><span class="nav-text">（1）添加一条数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）添加多条数据"><span class="nav-text">（2）添加多条数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）过滤非数据表字段"><span class="nav-text">（3）过滤非数据表字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（4）-补充-数据库操作AR模式"><span class="nav-text">（4）(补充)数据库操作AR模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、更新数据-U"><span class="nav-text">2、更新数据-U</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）更新方式一"><span class="nav-text">（1）更新方式一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）更新方式二-推荐"><span class="nav-text">（2）更新方式二(推荐)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、删除数据-D"><span class="nav-text">3、删除数据-D</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）删除方式一-推荐"><span class="nav-text">（1）删除方式一(推荐)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）删除方式二AR模式"><span class="nav-text">（2）删除方式二AR模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、查询数据-R"><span class="nav-text">4、查询数据-R</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）获取一条记录"><span class="nav-text">（1）获取一条记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）获取多条记录"><span class="nav-text">（3）获取多条记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（4）设置数据返回类型"><span class="nav-text">（4）设置数据返回类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、连贯操作"><span class="nav-text">5、连贯操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）where条件查询"><span class="nav-text">（1）where条件查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）join联表"><span class="nav-text">（2）join联表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、聚合（统计）函数"><span class="nav-text">6、聚合（统计）函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、模型完成时间戳的自动维护"><span class="nav-text">7、模型完成时间戳的自动维护</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、通过Db构造器操作数据库"><span class="nav-text">三、通过Db构造器操作数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、查询数据-R"><span class="nav-text">1、查询数据-R</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、添加数据-C"><span class="nav-text">2、添加数据-C</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、删除数据-D-1"><span class="nav-text">3、删除数据-D</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、更新数据-U"><span class="nav-text">4、更新数据-U</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（1）更新数据表中的数据"><span class="nav-text">（1）更新数据表中的数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（2）更新某个字段的值"><span class="nav-text">（2）更新某个字段的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（3）自增或自减一个字段的值"><span class="nav-text">（3）自增或自减一个字段的值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、执行原生sql语句"><span class="nav-text">5、执行原生sql语句</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TP5第三天"><span class="nav-text">==TP5第三天==</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一、composer概述"><span class="nav-text">一、composer概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、什么是composer"><span class="nav-text">1、什么是composer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、安装composer"><span class="nav-text">2、安装composer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、为composer配置国内镜像"><span class="nav-text">3、为composer配置国内镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、composer相关命令"><span class="nav-text">4、composer相关命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、使用composer安装tp5验证码"><span class="nav-text">二、使用composer安装tp5验证码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TP5第四天"><span class="nav-text">==TP5第四天==</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一、XSS攻击"><span class="nav-text">一、XSS攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、xss介绍"><span class="nav-text">1、xss介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、防止xss攻击（防止js攻击）"><span class="nav-text">2、防止xss攻击（防止js攻击）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1、使用htmlspecialchars函数防止"><span class="nav-text">2.1、使用htmlspecialchars函数防止</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2、使用插件HTMLPurifier防止XSS攻击"><span class="nav-text">2.2、使用插件HTMLPurifier防止XSS攻击</span></a></li></ol></li></ol></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"> 

  
  <span> Copyright </span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">
	 
		<a href="/admin" target="_blank">Kuma</a>
	 
  </span>
  
&copy; 2015 –  
<span itemprop="copyrightYear">2019</span>
  
  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">923k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">13:59</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v6.5.0</div>



  <span class="post-meta-divider">|</span>


  <a href="http://www.miitbeian.gov.cn" rel="noopener" target="_blank">粤备案：666666666 </a>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    
	
    
      <div>
        
  <script>
    window._bd_share_config = {
      "common": {
        "bdText": "",
        "bdMini": "1",
        "bdMiniList": false,
        "bdPic": ""
      },
      "image": {
        "viewList": ["tsina", "douban", "sqq", "qzone", "weixin", "twi", "fbook"],
        "viewText": "分享到：",
        "viewSize": "16"
      },
      "slide": {
        "bdImg": "5",
        "bdPos": "left",
        "bdTop": "100"
      }
    }
  </script>

<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      </div>
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.5.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      
        // ref: https://github.com/ForbesLindesay/unescape-html
        var unescapeHtml = function(html) {
          return String(html)
            .replace(/&quot;/g, '"')
            .replace(/&#39;/g, '\'')
            .replace(/&#x3A;/g, ':')
            // replace all the other &#x; chars
            .replace(/&#(\d+);/g, function (m, p) { return String.fromCharCode(p); })
            .replace(/&lt;/g, '<')
            .replace(/&gt;/g, '>')
            .replace(/&amp;/g, '&');
        };
      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                content = unescapeHtml(content);
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  
  

  


  
  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>


  
  

  
  

  


</body>
</html>
